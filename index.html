<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>BANKBOOKZ&#8482;</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" href="./favicon.ico" />
        <script src="./data/default_data.js"></script><!--****************LOAD-CUSTOM-DATA-MODULE******************-->
        <script  > //****************LOAD-CUSTOM-DATA-MODULE******************
            console.log("Imported Data:")
            // console.log(`RAW TRADES:${default_raw_trade_data.length}`)
            console.log(`MONTH TRADES:${Object.keys(default_TRADE_DATA_MAP_Monthly).length}`)
            console.log(`TICKRS, BTC(months):${Object.keys(default_TICKR_DATA_MAP_Monthly['BTC']).length}`)
            console.log(`TICKRS, ETH(months):${Object.keys(default_TICKR_DATA_MAP_Monthly['ETH']).length}`)
            // console.log(`BTC_TXNZ: MONTH${Object.keys(default_BTC_TRADEZ).length}`);
        </script>  <!-- **************************END-CUSTOM-DATA-MODULE******************-->      
        <!-- <script type="text/javascript"
            src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script> -->
        <!-- <script type="text/javascript" src="./module/derivative_lwc_2.js"></script> -->
        <script type="text/javascript" src="./module/lwc_dev_deriv_4.2.js"></script>


        
<style>
    body{ background:black; color:steelblue; font-size: 1em;padding: 1em 2% 2% 2%;
        font-family: verdana;height: 100%; min-height: 100%; display: flex;
        flex: 1;flex-direction: column; margin-top:2em;user-select:none;
    }   
    /* FRAME *******************************FRAME*****************************/
    .FRAME{ border:solid 1px steelblue;box-shadow: 1px 1px 3px 0px steelblue;
        border-radius: 10px;padding: 2%;margin: 0.333em;
    }
    .BTN {color:aqua;background:#000033;border:solid 1px seagreen;
        text-align: center;border-radius:13px;box-shadow: 1px 1px 1px teal;
        cursor:pointer;height: 1.444em;
    }
    .BTN:hover{color:lime;border:solid 1px lime;box-shadow:1px 1px 1px black;}
    .BTN:active{color:cyan;background:blue;border:solid 1px teal;box-shadow:1px 1px 1px black;height: 1.444em;}    
    .BTN.selectedMAINBTN{color:cyan;background:darkblue;border:solid 1px teal;}
    .blackBTN.selectedSUBBTN{color:cyan;box-shadow: inset 1px 1px 12px 0px blue;border:solid 1px teal;}
    /* BTN **********************************BTN**************************/
    /* .BTN{background:grey;border-radius: 8px;border:solid 1px darkslateblue;font-size:0.888em;
        cursor:pointer;color:cyan;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;} */
    .blackBTN{border-radius: 13px;background:black;cursor: pointer;font-size: 0.777em;
        color: aqua;line-height:1;box-shadow:1px 1px 1px aqua;padding: 0.555% 1% 0.555% 1%;}
    /**************RESPONSIVE BTN *******************/
    /* .BTN:hover{border:1px solid steelblue; color:purple}
    .BTN:active{border:1px solid lime; color:green} */
    .blackBTN:hover{border:1px solid lime;  background:black;  color:green}
    .blackBTN:active{border:1px solid steelblue;  background:black; color:purple}
    @media only screen and (max-width: 800px) { /************* TABLET */
        body{  background-color: #00070d;}
        .BTN{font-size:1.111em;}
        /* .blackBTN{font-size:0.999em;} */
    }  
    @media only screen and (max-width: 500px) { /************* PHONE */
        body{ background-color: #07000c; }
        .BTN{font-size:1em;}
        .blackBTN{font-size:0.888em;}
    }
    /* ***********************************CUSTOM SCROLLBAR****************************/
    .scrollBarV {overflow-x:scroll;}
    .scrollBarV::-webkit-scrollbar-track { background-color: #010213;  border-radius: 13px; }
    .scrollBarV::-webkit-scrollbar { width: 0.666em; height: 100%; }
    .scrollBarV::-webkit-scrollbar-thumb { background-color: #04223c; border-radius: 13px;
        background-image: -webkit-linear-gradient(0deg, rgba(255, 255, 255, 0.6) 26%, transparent 26%, transparent 51%, rgba(255, 255, 255, -0.4) 51%, rgba(255, 255, 255, 0.6) 74%, transparent 74%, transparent);
    } 
    .txtSizer::-webkit-scrollbar{ width:1.222em; background:black;}
    /* option:active {
        background-color: darkslateblue;
        color: aqua;
    }  */
    /*******CUSTOM MAIN MENU *******************MAIN MENU*********************************/
    .MAIN_MENU {background:rgb(72, 80, 111);border:solid 1px rgb(0, 128, 45);border-radius: 13px;
        padding:0.666em 1em 0.666em 1em;box-shadow: inset 0px 3px 10px purple;
        display: flex;justify-content: space-evenly;max-width: 80%;margin: -1em auto 1.111em auto;
        font-size: 0.666em;padding: 0.444em;display: flex;flex:0;
    } 
    .hiddenTab{ display:none !important;}
    /* CUSTOM HR ***************************HR***********************/
    hr {border-top:solid 1px steelblue; border-bottom: none; border-radius: 2px;}    
    /* CUSTOM INPUT ***************************INPUT***********************/
    .tkrTXT_BOX { border-radius: 13px;text-align: center;background: darkslategrey;
        color: cyan;width:5em;padding: 0;font-size:0.888em;margin: 0.444em 0px;
    }
    /* END CUSTOM INPUT ***************************END INPUT***********************/
    .deleteTXT{font-size: 0.666em;margin: 0 0 0 1em;padding: 0.222em 0.222em 0.222em 0.444em;
        display: flex;
    }
    .defaultTXT{font-size:0.888em}
    .delTXTBTN{color: aqua;background: #000033;border: solid 1px seagreen;width: 1em;
        border-radius: 50%;box-shadow: 1px 1px 1px teal;cursor: pointer;height: 1.222em;
        font-size: 1em;display: flex;justify-content: center;align-items: center;
        margin-left: 0.222em;padding-bottom: 0.222em;
    }
    /*******END CUSTOM MAIN MENU *******************MAIN MENU*********************************/
    /* CUSTOM TITLES ***************************TITLES***********************/
    .mainTitle {font-size: 1.444em;display:flex;justify-content: space-between; padding: 0em 1em 0 1em;
        text-shadow: -8px -1px 8px blue;}
    /* CUSTOM EXPANDER ***************************EXPANDER***********************/
    .expanderROW {display:flex;justify-content:space-between;border-bottom:1px dashed #021d33;
        padding: 0.222em 0em 0.333em 0em; margin: 0 2% 0.333em 2%;
    }
    .expanderTITLE{font-size:0.888em;color:steelblue;    margin-top: 0.333em;}
    .expanderBTN {color:aqua;background:#000033;border:solid 1px seagreen;
        width: 1.444em;text-align: center;border-radius: 50%;box-shadow: 1px 1px 1px teal;
        cursor:pointer;height: 1.444em;
    }
    .expanderBTN:hover{color:cyan;background:darkblue;border:solid 1px teal;}
    .expanderBTN:active{color:cyan;background:blue;border:solid 1px teal;box-shadow:1px 1px 1px black;
    }
    /** END CUSTOM EXPANDER ******************END EXPANDER*********************************************/   
    /**  **************************SELECTOR*************************************/
    .chartBTN {background:steelblue;border-radius: 10px;border: 1px solid orangered;
        padding: 0.666%;}
    .chartBTN:hover{color:aqua;background:black;}
    .chartSELECTOR {background:black; color:steelblue;border-radius: 10px;border: 1px solid aqua;
        padding:0.333% 0.444em 0.333% 0;font-size: 1em;height: 1.444em;text-align:right;}
    .chartSELECTOR:hover{color:aqua;background:black;}
    .chartSELECTOR:focus {border-color: teal;
    }/* focus border */
    .chartSELECTOR:focus option:checked {background-color:black;color:limegreen;
    } /* focused item */
    .chartSELECTOR:focus-visible{outline-color: teal;
    } /* focused item */
    /* ********************SUBSELECTOR*****************************/
    .subSELECTOR {background:black; color:steelblue;border-radius: 10px;border: 1px solid aqua;
        padding:0.333% 0.444em 0.333%0;font-size:0.777em;height:1.444em;text-align:right;}
    .subSELECTOR:hover{color:aqua;background:black;}
    .subSELECTOR:focus {border-color: teal;
    }/* focus border */
    .subSELECTOR:focus option:checked {background-color:black;color:limegreen;
    } /* focused item */
    .subSELECTOR:focus-visible{outline-color: teal;
    } /* focused item */
    /**  *************************END SELECTOR**************************************/   
input[type="checkbox"] {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    width: 20px;
    height: 20px;
    border: 0px solid blue;
    border-radius: 44%;
    background-color: black;
    cursor: pointer;
    border: 2px solid purple;
  background-color: #000;
  color:aqua;
  margin-left: 2em;
}
input[type="checkbox"]:after {
  border: 2px solid #0fd05f;
  border-radius: 3px;
  background-color: #000;
  border-radius: 44%;
  /* width: 2px; */
  /* min-width:2em; */
  color:aqua;
  width: 20px;
  padding:0 0.111em 0 0.111em;
  margin: -1px 0 0 -1px;
  /* margin-left: 2em; */
    /* height: 20px; */
}
input[type="checkbox"]:checked {
    width: 20px;
    /* min-width:2em; */
  /* background-color: blue; */
  content: '\2714'; /* Checkmark character */
  border: 2px solid #0fd05f;
  border-radius: 44%;
  background-color: #000;
  color:aqua;
}   
input[type="checkbox"]:checked:after {
    width: 20px;
    /* min-width:2em; */
  background-color: blue;
  content: '\2714'; /* Checkmark character */
  border: 2px solid #0fd05f;
  border-radius: 44%;
  background-color: #000;
  color:aqua;
}   
    /** CUSTOM TV CHARTS *********************CHARTS******************************************/    
    .tv-lightweight-charts{ margin: 1em 0 1em 0; border-radius:13px;}
    /** END  TV CHARTS *************************CHARTS**************************************/   
    /** API ***************************************************************/
    #API_BOX{display:flex;border: solid 1px steelblue;
        border-radius: 13px;padding: 2px 10%;color: #022e64;align-items: center; 
        justify-content: space-between;flex-wrap: wrap;margin: 12px auto 1.666em auto;
    max-width: 30em;
    min-width: 50%;}
    @media only screen and (max-width: 800px) { /************* TABLET */
        #API_BOX{margin: 8px 10% 1em 10%;}
    }  
    @media only screen and (max-width: 500px) { /************* PHONE */
        #API_BOX{margin:0 0 1em 0; padding: 0;}
    }        
    #keyBOX{ margin:1%;border: solid 1px steelblue;font-size: 0.777em;}
    #keyINPUT:-webkit-autofill { -webkit-box-shadow: 0 0 0px 1000px #233453 inset;}
    /** END API ***************************************************************/ 
    /** VIEW IMPLEMENTATIONS ***************************************************/   
    .tkrROWZ{margin: 1%; width:92%; border:solid 1px steelblue; display: flex;justify-content: space-between;
        border-radius:18px;padding: 0 3% 0 3%; align-items: center; flex-wrap: wrap;
    } 
    .tkrSubBox{margin: 1%; width:92%; border:solid 1px steelblue; display: flex;justify-content: space-between;
        border-radius:18px;padding: 0 3% 0 3%; align-items: center; flex-wrap: wrap;flex-direction:column;
    } 
    .tkrMenuBox{margin: 1%; width:95%; border:solid 1px steelblue; display: flex;justify-content: space-between;
        border-radius:18px;padding: 0 1% 0 1%; align-items: center;flex-direction:column;
    } 
    .tkrSubMenu{display: flex;justify-content: space-around;width: 97%;border: solid 4px #02025f;border-radius: 8px;
    box-shadow: -1px -1px 8px 0px rebeccapurple;margin: 0 0 1em 0.222em;}
    .tkrTTL{width: 100%;display: flex;align-items: center;justify-content: space-between; }
     /** END VIEW IMPLEMENTATIONS *****************************************/   
    .BTNBOX{display: flex;width: 50px;justify-content: space-between;}
    .tkrTXTArea{ overflow-x:visible;flex: 1 1 0;resize:horizontal;background:black;color: aqua; padding: 1em; height: 10em;}
    .editorBTN{color:aqua;font-size: 0.666em;padding: 0em 0.4em 0.2em 0.4em;border: solid 1px aqua; box-shadow: inset -2px 0px 1px steelblue;
        border-radius: 44%;margin-left: 1em;cursor: pointer;                
    }
    .BOOKFRAME_Item{
        box-shadow: inset 1px 1px 8px aqua;
        border-radius: 22px;
        margin: 0.888em 0.444em;
        padding: 1em;
    }
</style>      
</head>
<body class="scrollBarV">
    <header style="position:absolute;top:0.555em;align-self:center;display:flex;">
        BANKBOOKZ<span style="font-size:0.444em">&#8482;</span></header>
    <menu class="MAIN_MENU">
        <button id="TCKR_VIEW_BTN" class="BTN" style="margin:0 0em 0 0em;" onclick="go_TICKR_VIEW()">TICKRZ</button>
        <button id="BANK_VIEW_BTN" class="BTN" style="margin:0 1em 0 1em;" onclick="go_BANK_VIEW()">BANKZ</button>
        <button id="BOOK_VIEW_BTN" class="BTN" style="margin:0 0em 0 0em;" onclick="go_BOOK_VIEW()">BOOKZ</button>
        <button id="DATA_VIEW_BTN" class="BTN" style="margin:0 1em 0 1em;" onclick="go_DATA_VIEW()">DATA</button>
    </menu>
    <aside id="USER_MSG_BOX" style="z-index:10;position: absolute;margin: 0 14%;display: flex;width: 66%;
        border: solid 1px yellow;border-radius: 30px;background: black;justify-content: space-around;top:88px;">
        <span style="margin: 1em;border: 1px solid orange;border-radius: 44px;box-shadow: 1px 1px 15px orange;">
            <span id="MSGIcon1" style="padding:1em;">icon1</span>
            <span id="MSGTXT" style="padding:1em;">message</span>
            <span id="MSGIcon2" style="padding:1em;">icon1</span>
        </span>
    </aside>
    <section id="TCKR_VIEW" class=" hiddenTab" style="border: solid 1px steelblue;justify-content: center; 
    flex-direction: column;border-radius: 13px;flex: 1;height: 10em;display: flex;
    padding: 1em 3% 2% 3%;max-width: 50em;margin: 0 10%;align-self: center;width: 88.888%;
    box-shadow: inset 1px 1px 11px 0px cyan;"/> 
    
        <!--style="flex:1;border-radius: 13px; border: solid 1px steelblue; 
        box-shadow: inset 1px 1px 11px 0px cyan; padding:2%;padding-top: 3%;padding-left:4%; 
        max-width:50em;color: cyan;line-height:1.666em;">-->
        <header class="mainTitle expanderROW">
            <span class="boxTitle">
                <span style="font-size:0.777em; color:cyan">1</span>
                <span>TICKERS</span>
            </span>
        </header>
        <hr/>
        <article id="TKR_RENDER_FRAME"></article>
        <aside style="display: flex;padding: 0.666em 0 0.222em 2em;align-items: flex-end;">
            <span style="font-size:1em;">INFO:</span><br>
            <span style="font-size:0.888em;">Add ticker symbol to track trades.</span><br>
        </aside>
        <menu style="display: flex;justify-content: flex-end; padding-right: 2%;margin-top:0.222em;">
            <button id="addTickBtn1" class="blackBTN" onclick="add_TKRZ_Click()">add🎇</button>
            <!-- <button id="saveTickBtn1" class="blackBTN" style="margin-left:1em;" onclick="saveTickerClick()">save🌟</button> -->
        </menu>
    </section><!-- END TCKR VIEW-->
    <section id="BANK_VIEW" class=" hiddenTab" style="border: solid 1px steelblue;justify-content: center; 
    flex-direction: column;border-radius: 13px;flex: 1;height: 10em;display: flex;
    padding: 1em 3% 2% 3%;max-width: 50em;margin: 0 10%;align-self: center;width: 88.888%;
    box-shadow: inset 1px 1px 11px 0px #00ffa5;"/> 
        <!-- style="flex: 1;border-radius: 13px;border: solid 1px steelblue;box-shadow: inset 1px 1px 11px 0px #00ffa5;
            padding: 2%;padding-top: 3%;padding-left: 4%;max-width:50em; color: cyan;line-height: 1.666em;"
            >-->
        <article class="mainTitle expanderROW">
            <span class="boxTitle" style="width:100%;">
                <span></span><span style="font-size:0.777em; color:cyan">2</span>
                MARGINZ</span>
            </span>
            <button class="expanderBTN" style="padding:0;font-size:0.777em;line-height: 1.444em;" 
                onclick="expander_BANKZ_Click(event)">✧</button>
        </article>
        <hr> 
        <article id="MARGINZ_RENDER_FRAME"></article>
        <hr> 
        <button id="detailsBtn1" class="blackBTN" onclick="setMarginDetailsClick(event)">details💎</button> 
    </section><!-- END BANKZ VIEW -->
    <!-- *********************************BOOKZ_-VIEW********************************-->
    <section id="BOOK_VIEW" style="border: solid 1px steelblue;justify-content: center; 
        flex-direction: column;border-radius: 13px;flex: 1;height: 10em;display: flex;
        padding: 1em 3% 2% 3%;max-width: 50em;margin: 0 10%;align-self: center;width: 88.888%;
        box-shadow:inset 1px 3px 13px 0px steelblue;"/>
        <!-- border:solid 1px steelblue;justify-content: center;flex-direction: column;
        border-radius: 13px;display:flex; padding:3%;flex:1;
        box-shadow:inset 1px 3px 13px 0px steelblue;max-width:50em;"> -->
        <article id="BOOKZ_RENDER_FRAME"></article>
        <hr> 
        <section id="BOOKFRAME_XMPL" class="BOOKFRAME_Item">
            <header class="mainTitle expanderROW">
                <span>XMPL</span>
                <span class="expanderBTN" style="font-size:0.777em;" onclick="expander_BOOKZ_Click(event)">✧</span>
            </header>
            <menu style="justify-content: space-evenly; border-radius: 13px; flex: 1 1 0%; display: flex; 
                margin-top: 0;padding: 0.222em 0px; width: 66.666%; align-self: center;">
                <span>
                    <div style="background:#26a69a;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                    margin-right: 0.5em;"></div>
                    <span style="font-size:0.444em;">PRICE</span>
                </span>
                <span>
                    <div style="background:#2962ff;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                    margin-right: 0.5em;"></div>
                    <span style="font-size:0.444em;">PROFITnLOSS</span>
                </span>
            </menu>
            <article id="candelstickFRAME_XMPL" style="justify-content:center;
                display:flex;border:solid 1px steelblue;border-radius:22.222px;margin: 0.222em 0;">
            </article>
            <section style="justify-content: center;flex-direction: column;padding: 0 2% 0 2%;
                border-radius: 13px;margin: 0.444em 0;display: flex;border: solid 1px teal;">
                <header class="expanderROW">
                    <span class="expanderTITLE">PnL:</span>
                    <span class="expanderBTN" onclick="MINMAX(event.target)">✧</span>
                </header>
                <article id="baselineFRAME_XMPL" style="justify-content: center;margin: 0.222em 0;
                 display:flex; height:10em;">
                </article>
                <header style="font-size: 0.888em;margin-bottom:1em;display:flex;justify-content: space-between; padding: 2em 3em 0 2em">
                    <span>
                        <div style="background:#26a69a;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                        margin-right: 0.5em;"></div>                        
                        <span style="font-size:0.666em;margin-top: 0.333em;color:steelblue">PnL:</span>
                        <span style="font-size:0.666em;">234</span>
                    </span>
                    <span>
                        <div style="background:#26a69a;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                        margin-right: 0.5em;"></div>
                        <span style="font-size:0.666em;">BOOK:</span>
                        <span style="font-size:0.666em;">1,234</span>
                    </span>
                    <span>
                        <div style="background:#26a69a;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                        margin-right: 0.5em;"></div>
                        <span style="font-size:0.666em;">BANK:</span>
                        <span style="font-size:0.666em;">444</span>
                    </span>
                </header>                  
            </section>            
            <menu id="trend_FRAME_XMPL" class="FRAME" style="justify-content: center;flex-direction: column;
                border-radius: 13px; flex:1; display:flex;margin: 0.444em 0;height: 22em;">
                <header class="expanderTITLE">Trends:</header>
                <section id="trend_line_chart_xmpl" style="display: flex;justify-content: center;height: 20em;"></section>
            </menu>
            
            <menu id="bands_FRAME_XMPL" class="FRAME" style="justify-content: center;flex-direction: column;
                border-radius: 13px; flex:1; display:flex; margin: 0.444em 0;height: 22em;">
                <header class="expanderTITLE">Bands:</header>
                <section id="xmpl_bands_chart" style="display: flex;justify-content: center;height: 20em;"></section>
            </menu>

            <menu id="structs_FRAME_XMPL" class="FRAME" style="justify-content: center;flex-direction: column;
                border-radius: 13px; flex:1; display:flex; margin: 0.444em 0;height: 24em;">
                <header class="expanderTITLE">Structs:</header>
                <div id="xmpl_struct_chart" style="display: flex;justify-content: center;height:22em;"></div>
                <div id="lineEditor" dataPt="none" style="border:solid 1px steelblue;visibility:hidden;
                    position:absolute;z-index:11;color:aqua;background: #04013e;border-radius:13px;
                    padding: 0.222em 0.666em 0.222em 0.666em;    box-shadow: inset 1px 3px 8px blue;
                    display: flex;justify-content: space-between; align-items: center; width: 250px;">
                    <span><span class="editorBTN"  onclick="smlLine(event)">sml</span>
                          <span class="editorBTN"  onclick="medLine(event)">med</span>
                          <span class="editorBTN" onclick="lrgLine(event)">lrg</span></span>
                    <input type="color" value = "#003264" style="border: 1px solid blueviolet;border-radius: 44px; background: black;"
                    onchange="setLineColor(event)"/>
                    <span onclick="((event) => {
                        event.target.parentElement.style.visibility = 'hidden'
                    })(event)" style="padding: 0em 0.4em 0.2em 0.4em;border: solid 1px aqua; 
                    box-shadow: inset -2px 0px 2px steelblue;line-height: 1.111em;
                        border-radius: 44%;margin-left: 1em;cursor: pointer;">x</span>
                </div>
            </menu>
            <menu id="avgs_FRAME_XMPL" class="FRAME" style="justify-content: center;flex-direction: column;
                border-radius: 13px; flex:1; display:flex;margin: 0.444em 0;height: 22em;">
                <header class="expanderTITLE">Averages:</header>
                <div id="xmpl_avgs_chart" style="display: flex;justify-content: center;height:20em;"></div>
            </menu>
        </section><!--***********************************************end BOOKFRAME-->     
    </section><!--end BOOKVIEW-->

    <section id="DATA_VIEW" style="border:solid 1px steelblue;justify-content: center;flex-direction: column;
    border-radius: 13px; flex:1; height:10em; display:flex; padding:1em 3% 2% 3%;max-width:50em;margin:0 10%;
    box-shadow: 1px 3px 13px 0px steelblue;align-self:center; width:88.888%;" class="hiddenTab">
        <article id="DATA_MENU_FRAME">
            <menu style="display:flex;flex-wrap: wrap;font-size: 0.999em;padding-left:0; margin-top: 0.333em;
                justify-content: space-evenly;border-bottom: 1px dashed #021d33;padding-bottom: 0.666em;">
                <button id="GALLERY_VIEW_BTN" class="blackBTN" onclick="showDataGalleryView('gallery')">GALLERY</button>
                <button id="IMPORT_VIEW_BTN" class="blackBTN" onclick="showDataGalleryView('import')">IMPORT</button>
            </menu>
            <main id="data_gallery_list"></main>
        </article>        

        <article id="DATA_GALLERY_FRAME"  style="height:35em; border:solid 1px steelblue;border-radius:10px;
        background: black; border: solid 1px lime;display: flex;flex-direction: column;align-items: center;" class="hiddenTab">
            <header style="margin:1em;width: 100%;padding-left:2em;">TICKER DATA:</header>
            <section id="render_TICKR_GALLERY" style="width: 88.888%;"></section>
        </article> 
        <article id="DATA_IMPORT_FRAME" style="height:35em; border:solid 1px steelblue;border-radius:10px;
                background: black; border: solid 1px lime;display: flex;flex-direction: column;align-items: center;" class="hiddenTab">
            <header style="margin:1em;width: 100%;padding-left:2em;font-size:0.888em">
                IMPORT TICKR DATA:</header>
            <footer id="API_BOX">
                <section id="keyBOX" style="display:flex;border: solid 1px steelblue;
                border-radius: 13px;padding: 2px 6px;color: #022e64;align-items: center;
                margin: 1em auto;">
                    AA_API:<input id="keyINPUT"  type="new-password" placeholder="api_key" 
                    style="margin-left: 1em; background:#233453;
                    border-radius: 10px 0px 0px 10px;"></input>
                    <button style="margin-right: 1em; background:#03cbcb;cursor:pointer;
                    border-radius: 0px 10px 10px 0px; font-size:0.777em;padding: 4px;" onclick="setAPIKEY();">SET</button>
                </section>  
                <div style="display: flex;align-items: center;width: 100%;justify-content: space-around;">
                    <section id="connectStatus" style="font-size: 0.666em;margin-right:2%;color:aqua;">disconnected</section>
                    <button id="latestBtn1" class="blackBTN" style="margin:1em 1% 1em 1%;"
                        onclick="getLastPriceClick()">GET Latest Prices🔄</button>
                </div>
            </footer>
            <header style="margin:1em;width: 100%;padding-left:2em;font-size:0.888em">
                IMPORT TRADE DATA:</header>
            <textarea id="render_TRADE_IMPORT" class="scrollBarV txtSizer" style="overflow-x:visible;flex:1 1 0;resize:horizontal;background: black;color: lime;
                width:80.888%;padding:2em;border-radius: 13px;box-shadow: 0px 0px 8px purple;">
            [{"tkr":"BTC","type":"BUY","mode":"Limit","ymd":"2020_4_3","ymtID":"2020_4_BTC",
                "amt":"111","shares":"0.0017","price":"64,428.71","role":""},
            {"tkr":"BTC","type":"BUY","mode":"Market","ymd":"2020_4_3","ymtID":"2020_4_BTC",
                "amt":"22","shares":"0.0003","price":"66,402.48","role":""},
            {"tkr":"BTC","type":"BUY","mode":"Market","ymd":"2020_4_3","ymtID":"2020_4_BTC",
                "amt":"44","shares":"0.0007","price":"66,058.39","role":""}]</textarea> 
            <footer class="main_footer">
                <button class="BTN" style="font-size:1em;margin:1em;" onclick="import_TradeClick()">
                    IMPORT TRADE DATA</button>
            </footer>               
        </article>        

        <article id="DATA_TICKR_FRAME" style="height:35em; border:solid 1px steelblue;border-radius:10px;
        background: black; border: solid 1px lime;display: flex;flex-direction: column;align-items: center;" class="hiddenTab">
            <header style="margin:1em;width: 100%;padding-left:2em;">EDIT TICKER DATA:</header>
            <section id="render_EDIT_TICKR_Frame" class="scrollBarV" 
                style="width: 94%;display: flex;flex-direction: column;margin: 0 2em 0 3em;
                    background: #00010b;">No Data. </section>
            <!-- <textarea id="render_TICKR_DATA" class="scrollBarV txtSizer"style="overflow-x:visible;flex: 1 1 0;resize:horizontal;background:black;
               color: lime;
                width:80.888%;padding: 4%;border-radius: 13px;box-shadow: 0px 0px 8px purple;margin-bottom: 1em;" >
            [{"tkr":"BTC","type":"BUY","mode":"Limit","ymd":"2020_4_3","ymtID":"2020_4_BTC",
                "amt":"111","shares":"0.0017","price":"64,428.71","role":""},
            {"tkr":"BTC","type":"BUY","mode":"Market","ymd":"2020_4_3","ymtID":"2020_4_BTC",
                "amt":"22","shares":"0.0003","price":"66,402.48","role":""},
            {"tkr":"BTC","type":"BUY","mode":"Market","ymd":"2020_4_3","ymtID":"2020_4_BTC",
                "amt":"44","shares":"0.0007","price":"66,058.39","role":""}]</textarea>  -->
            <footer class="main_footer" style="display:flex;width: 100%;height:2.222em;justify-content:space-around;
                align-items:center;margin-bottom: 1em;">
                <!-- <button class="BTN" style="font-size:1em;margin:1em;" onclick="save_TickerClick()">🌟SAVE🌟</button> -->
            </footer>   
        </article>        
        <article id="DATA_TRADE_FRAME" style="height:35em; border:solid 1px steelblue;border-radius:10px;
        background: black; border: solid 1px lime;display: flex;flex-direction: column;align-items: center;" class="hiddenTab">
            <header style="margin:1em;width: 100%;padding-left:2em;">EDIT TRADE DATA:</header>
            <section id="render_EDIT_TRADE_Frame" class="scrollBarV" 
            style="width: 94%;display: flex;flex-direction: column;margin: 0 2em 0 3em;
                background: #00010b;">No Data. </section>
            <!-- <textarea id="render_TRADE_DATA" class="scrollBarV txtSizer" style="overflow-x: visible;flex: 1 1 0;resize:horizontal;background: black;color: lime;
                width:80.888%;padding: 4%;border-radius: 13px;box-shadow: 0px 0px 8px purple;">
            [{"tkr":"BTC","type":"BUY","mode":"Limit","ymd":"2020_4_3","ymtID":"2020_4_BTC",
                "amt":"111","shares":"0.0017","price":"64,428.71","role":""},
            {"tkr":"BTC","type":"BUY","mode":"Market","ymd":"2020_4_3","ymtID":"2020_4_BTC",
                "amt":"22","shares":"0.0003","price":"66,402.48","role":""},
            {"tkr":"BTC","type":"BUY","mode":"Market","ymd":"2020_4_3","ymtID":"2020_4_BTC",
                "amt":"44","shares":"0.0007","price":"66,058.39","role":""}]</textarea>  -->
            <footer class="main_footer" style="display:flex;width: 100%;height:2.222em;justify-content:space-around;
                align-items:center;margin:1em 0;">
                <!-- <button class="BTN" style="font-size:1em;" onclick="save_TradeClick()">🌟SAVE🌟</button> -->
            </footer>   
        </article>        
    </section><!--end DATAVIEW-->
<script>// *************LOCAL_DB*********************
/*************************************************************\
 * bankbookz_DB - ability to save monthly data in localstorage
\*************************************************************/
let bankbookz_DB=null;
const bankbookz_DB_LOAD_MOCK_DATA=()=>{ //INIT DATA_MODEL XMPL
    bankbookz_DB = { 
        TRADE_TXNZ_YMT: default_TRADE_DATA_MAP_Monthly,
        TICKR_DATA_MAP_Monthly : default_TICKR_DATA_MAP_Monthly,
        TICKR_LIST:[
            {tkr:'BTC',lastLoadYMD:''},{tkr:'ETH',lastLoadYMD:''},
            {tkr:'AMZN',lastLoadYMD:''},{tkr:'NVDA',lastLoadYMD:''},
        ],
        METASTATE:{ 
            BOOKZ_EXPANDER:['BTC'], //multiple expansion.
            lastRefreshMap:{'BTC':'2020-10-11 00:00:00'},
            monthlySELECTORMap:{'BTC':'All Time'}
        } 
    }
    save_BANKBOOKZ_DB();
}
const bankbookz_DB_init=()=>{ //READ from LOCAL STORAGE
    try{
        bankbookz_DB = (localStorage.bankbookz_DB)?
        JSON.parse( localStorage.bankbookz_DB ):null;
        // bankbookz_DB = null; //DEV: load mock data for TEST
        if(!bankbookz_DB){ bankbookz_DB_LOAD_MOCK_DATA(); }
    } catch(e){ bankbookz_DB_LOAD_MOCK_DATA(); }
}; bankbookz_DB_init();
function save_BANKBOOKZ_DB(){ //singleton, save LocalDB;.
    console.log('SAVED BANKBOOKZ DB.')
    localStorage.bankbookz_DB = JSON.stringify(bankbookz_DB); //SAVE to LOCAL STORAGE 
}
</script><!--***********************END LOCAL DB*********************-->
<script  >// *************APP UTILITIES*********************
//*************************************************CUSTOM MINMAX***********
function MINMAX(TGT, setState){ //setState optional to force expand or collapse, otherwise toggle.
    const CURR_STATE = TGT.innerHTML; //get parent and hide/show everything but expanderROW
    const ROW = TGT.parentElement; //required
    if(ROW.classList.contains("expanderROW")){ //if row hide siblings.
        let aSibling = ROW.nextElementSibling;
        while (aSibling) { //loop next siblings
            if(CURR_STATE==='✴'||setState){ //COLLAPSE
                aSibling.style.display = 'flex'; //required
            } else { aSibling.style.display = 'none'; 
            }//EXPAND (default)
            aSibling = aSibling.nextElementSibling;
        }
        TGT.innerHTML = (CURR_STATE==='✴'||setState) ? '✧' : '✴';
    }
}
function MINMAX_Menu(e,setState){
    let tgt = e.target;
    const CURR_STATE = tgt.innerHTML;
    let aSibling = tgt.parentElement.nextElementSibling;
    if(CURR_STATE==='✴'||setState){ //COLLAPSE
        aSibling.style.display = 'flex'; //required
    } else { aSibling.style.display = 'none'; }//EXPAND (default)
    tgt.innerHTML = (CURR_STATE==='✴'||setState) ? '✧' : '✴';
}
function MINMAX_SubList(e,setState){
    let tgt = e.target;
    const CURR_STATE = tgt.innerHTML;
    let aSibling = tgt.parentElement.parentElement.nextElementSibling;
    if(CURR_STATE==='✴'||setState){ //COLLAPSE
        aSibling.style.display = 'flex'; //required
    } else { aSibling.style.display = 'none'; }//EXPAND (default)
    tgt.innerHTML = (CURR_STATE==='✴'||setState) ? '✧' : '✴';
}
//*************************************************END MINMAX***********
//**********************************CUSTOM USERMSG***********
const USER_MSG_BOX = document.getElementById('USER_MSG_BOX');
const MSGIcon1 = document.getElementById('MSGIcon1');
const MSGTXT = document.getElementById('MSGTXT');
const MSGIcon2 = document.getElementById('MSGIcon2');
function show_USERMSG (msg) {
    if(!msg || !msg.txt){return}
    let time = (msg.time)?msg.time:4000;
    USER_MSG_BOX.style.display = "flex";
    MSGTXT.innerText = msg.txt;
    MSGIcon1.innerText = (msg.icon)?msg.icon:'';
    MSGIcon2.innerText = (msg.icon)?msg.icon:'';
    // setTimeout( ()=>{ //HIDE
    //     USER_MSG_BOX.style.display = "none";
    // },time)
    setTimeout( ()=>{ //HIDE
        USER_MSG_BOX.style.opacity = 0.99;
        setTimeout( ()=>{ //HIDE
            USER_MSG_BOX.style.opacity = 0.88;
            setTimeout( ()=>{ //HIDE
                USER_MSG_BOX.style.opacity = 0.66;
                setTimeout( ()=>{ //HIDE
                    USER_MSG_BOX.style.opacity = 0.44;
                    setTimeout( ()=>{ //HIDE
                        USER_MSG_BOX.style.opacity = 0.11;
                        setTimeout( ()=>{ //HIDE
                            USER_MSG_BOX.style.opacity = 0;
                            setTimeout( ()=>{ //HIDE
                                USER_MSG_BOX.style.display = "none";
                                USER_MSG_BOX.style.opacity = 1;
                            },111)  
                        },111)  
                    },111) 
                },111)                 
            },222)                 
        },222)        
    },2000) //TODO: interpolate on and off.
};show_USERMSG({txt:'Welcome!',icon:'🌼',time:2000});
//**********************************END CUSTOM USERMSG***********
//*************************************************Pad Months With Zeros***********
function padTimeWithZeros(arr){ //sadly 01 format is standard
    let item, itemArr,padDay,padMonth;
    for(var i=0; i<arr.length; i++){
        item = arr[i];
        itemArr = item.time.split('-')
        padMonth = itemArr[1].padStart(2, '0'); 
        padDay = itemArr[2].padStart(2, '0'); 
        item.time=`${itemArr[0]}-${padMonth}-${padDay}`
    }
    return arr;
}
function ensureOrderASC(timeArray){ //time array for markers must be ASC.
    const orderedData = timeArray.sort((a, b) => {
        const [yearA, monthA, dayA] = a.time.split('-');
        const [yearB, monthB, dayB] = b.time.split('-');
        if (yearA !== yearB) return yearA - yearB;
        if (monthA !== monthB) return monthA - monthB;
        return dayA - dayB;
    });
    return orderedData;
}
function ensurePaddedYMT(YMT_id){
    let paddedId='',paddedMo,splitArr=[];
    splitArr = YMT_id.split("_")
    paddedMo = splitArr[1].padStart(2,'0');
    paddedId = `${splitArr[0]}_${paddedMo}_splitArr${splitArr[2]}`;
    return paddedId;
}
//*************************************************END Months With Zeros***********
//*******************************YMT - CUSTOM DATA MANIPULATION*************
function sort_YMT_KEYS(ymtSet) {
    return ymtSet.sort((a, b) => {
        const aParts = a.split('_');
        const bParts = b.split('_');
        if (aParts[0] !== bParts[0]) { //compare years
      return parseInt(aParts[0]) - parseInt(bParts[0]);
    }
    return parseInt(aParts[1]) - parseInt(bParts[1]);//compare months
  });
}
function fillout_YMT_KEYS(ymtArr,TGTymt){ //skipped months, added.
    ymtArr = sort_YMT_KEYS(ymtArr) //Required ASC for LWC
    const cumulativeSet = [];
    const ymtSet = new Set(ymtArr)
    const yearSet = new Set(ymtArr.map(item => item.split('_')[0]));
    const monthSet = new Set(ymtArr.map(item => item.split('_')[1]));
    const yearsArr = Array.from(yearSet);
    const tkr = ymtArr[0].split('_')[2];
    let tgtYMT='',year,foundStart=false,foundEnd=false;;
    let lastItem = ymtArr[ymtArr.length-1]
    for (let yrIDX = 0; yrIDX <= yearsArr.length; yrIDX++) { // Adjust year range as needed
        year = yearsArr[yrIDX];
        for (let month = 1; month <= 12; month++) {
            // tgtYMT = `${year}_${month}_${tkr}`;//unpadded
            tgtYMT = `${year}_${month.toString().padStart(2, '0')}_${tkr}`;//Pad Month
            if (ymtSet.has(tgtYMT)) {
                foundStart = true;
                cumulativeSet.push(tgtYMT);
                if(tgtYMT===lastItem || tgtYMT===TGTymt){
                    foundEnd=true;
                }
            } else if(foundStart) { //cumulate till end.
                cumulativeSet.push(tgtYMT); 
            } 
            if (cumulativeSet.length>=12 || foundEnd){ 
                foundEnd=true; //hardstop 12 end not found
                break;
            }
        }
        if(foundEnd){break;}
    }
    return cumulativeSet;
}
//********************END YMT - CUSTOM DATA MANIPULATION*************
//---*************CUSTOM CHART_SELECTOR------------------
function getDataSelector(e){
    let TGT = e.target;
    const selectedIndex = TGT.selectedIndex;
    if (selectedIndex !== -1) {
        const selectedOption = TGT.options[selectedIndex];
        console.log("Selected value:", selectedOption.value);
        console.log("Selected text:", selectedOption.text);
    } else {
        console.log("No option selected.");
    }
}
</script><!--***********END APP UTILITIES *********************-->
<script  >// ********************MAIN DYNAMIC CHART**********************
let DYNA_CHART_CANDLES = []; //for screen resize
function init_DYNA_CHART_Candle(tgtELEM){
    const chartOptions = {width:400,height:300,autoSize:false,
        layout:{textColor:'steelblue',fontSize:9,fontFamily:'sans-serif',//'Roboto',// fontBoldWeight: 800,
            background:{type:'solid',color:'#000000'} },
        grid: { vertLines: { color: "#080808" }, horzLines: { color: "#080808" } },
        crosshair:{mode:LightweightCharts.CrosshairMode.Normal,
            vertLine:{color:"darkslategrey"},horzLine:{color:"darkslategrey"} },
        // rightPriceScale:{visible:false},leftPriceScale:{visible:true},
        // priceScale:{position: 'right',scaleMargins: {top: 0.2, bottom: 0.2 } },
    }
    let tgtTKR = tgtELEM.id.split('_')[1]; 
    let candleSeriesDATA = getCandleSeriesDATA(tgtTKR);
    if(!candleSeriesDATA.length){ tgtELEM.innerHTML='<i style="font-size:0.555em;margin:0.888em;">No data.</i>'; return; }
    tgtELEM.innerHTML=''; //blank out
    const Dyna_Chart_CandleStick = LightweightCharts.createChart(tgtELEM, chartOptions);  
    // CANDLESTICK-SERIES******************************************************        
    const candlestickSeries = Dyna_Chart_CandleStick.addCandlestickSeries({
        priceScaleId: 'right', layout: {textColor:'steelblue',background: { type: 'solid', color: '#000000' } },
        wickUpColor: "#26a69a",upColor: "#26a69a",wickDownColor: "rgb(225, 50, 85)",downColor: "rgb(225, 50, 85)",
    });
    candleSeriesDATA = ensureOrderASC(candleSeriesDATA);   //IMPORT ASC - todo
    candlestickSeries.setData(candleSeriesDATA);
    let candleSeriesSUBSELECT = getCandleSubSELECT(tgtTKR); //SUB SELECTORS - LOGIC.
    if(candleSeriesSUBSELECT==='struct'){ //STRUCTURE LINES.

    }else{ //TRADE_MARKERS
        let tradeMarkerData = getMarker_TRADE_DATA(tgtTKR);
        tradeMarkerData = padTimeWithZeros(tradeMarkerData); //IMPORT PAD - todo
        tradeMarkerData = ensureOrderASC(tradeMarkerData);   //IMPORT ASC - todo
        candlestickSeries.setMarkers(tradeMarkerData);        
    }
    Dyna_Chart_CandleStick.timeScale().fitContent();    
    resize_DYNA_CHART_Candle(Dyna_Chart_CandleStick);
    DYNA_CHART_CANDLES.push(Dyna_Chart_CandleStick); //for screen resize
}; //END INIT DYNA_CHART - candle *****************************************
function resize_DYNA_CHART_Candle(elem){
    let frame = document.getElementById('BOOK_VIEW');
    let maxWidth = (frame.offsetWidth>888)?777:(frame.offsetWidth<400)?frame.offsetWidth-60:frame.offsetWidth-100;//(frame.offsetWidth*0.1);
    let maxHeight = (frame.offsetWidth>800)?600:frame.offsetWidth-200;    
    if(maxWidth<100 || maxHeight<50){return}
    elem.resize(maxWidth, maxHeight);
}
/*********************************************DYNA_SELECTOR**********************/
function init_DYNA_SELECTOR(tkr){ //Put all the months in the combo list.
    let selectELEM = document.getElementById('DYNA_YMT_SELECTOR_'+tkr)
    selectELEM.innerHTML = '';
    selectELEM.addEventListener("change", (event) => {DYNA_SELECTOR_Change(event)}); 
    const option1 = document.createElement("option");
    option1.text = "Last 33";
    option1.value = "Last 33"; 
    selectELEM.appendChild(option1);
    const option2 = document.createElement("option");
    option2.text = "All Time";
    option2.value = "All Time"; 
    selectELEM.appendChild(option2);
    let tgtData = bankbookz_DB.TICKR_DATA_MAP_Monthly[tkr];
    if(tgtData){ //error trap no data
        let optionKEYS = Object.keys(tgtData);
        optionKEYS.reverse();//DESC opposite of LWC
        let dynaOption;
        for(ymd of optionKEYS){
            dynaOption = document.createElement("option");
            dynaOption.text = ymd;
            dynaOption.value = ymd; 
            selectELEM.appendChild(dynaOption);
        }
    }
    if(!bankbookz_DB.METASTATE.monthlySELECTORMap[tkr]){ //save selection
        bankbookz_DB.METASTATE.monthlySELECTORMap[tkr] = 'Last 33'; //default 
    }
    selectELEM.value = bankbookz_DB.METASTATE.monthlySELECTORMap[tkr]
    //SET TEXT SELECTOR TITLES
    const selector_TITLE_TXT = document.getElementById(`candlestickTITLES_${tkr}`);
    selector_TITLE_TXT.innerHTML = `<span class="defaultTXT">${bankbookz_DB.METASTATE.monthlySELECTORMap[tkr]}</span>`;
}
function DYNA_SELECTOR_Change(e){
    let TGTymt = e.target.value;
    let TGTID = e.target.id;
    let TGTtkr = TGTID.split("_")[3]
    bankbookz_DB.METASTATE.monthlySELECTORMap[TGTtkr] = TGTymt;
    save_BANKBOOKZ_DB();
    // DYNAMIC SELECTOR BEHAVIOR **************************************:
    const selector_TITLE_TXT = document.getElementById(`candlestickTITLES_${TGTtkr}`);
    if(TGTymt==='Last 33' || TGTymt==='All Time'){
        selector_TITLE_TXT.innerHTML = `<span class="defaultTXT">${TGTymt}</span>`;
        let chartELEM = document.getElementById(`candlestickFRAME_${TGTtkr}`)
        init_DYNA_CHART_Candle(chartELEM);          
        return;
    }    
    const currentSELECTORZ_TXT = selector_TITLE_TXT.innerText;
    const currentSELECTORZ = selector_TITLE_TXT.children;
    let newSELECTORZ = [TGTymt];//default selection
    for(var f=0;f<currentSELECTORZ.length;f++){
        if(currentSELECTORZ_TXT.indexOf('Last 33')>-1 ||
        currentSELECTORZ_TXT.indexOf('All Time')>-1){ break; }
        if(currentSELECTORZ[f].innerText.indexOf(TGTymt)>-1){//remove
            continue;
        }
        newSELECTORZ.push(currentSELECTORZ[f].innerText.split('\nx')[0])//trim deletebtn
    }
    if(newSELECTORZ.length>1){ //VIEW MULTIPLE MONTHS
        newSELECTORZ = fillout_YMT_KEYS(newSELECTORZ,TGTymt)
        let wrappedDATA = newSELECTORZ.map( (e,i)=>{
            if(i===0){return  `<span class="defaultTXT">${e}</span>`}
            return `<span class="deleteTXT">${e} <button class="delTXTBTN" onclick="delete_SELECTOR_TXT(event)">x</button> </span>`;
        } ) 
        selector_TITLE_TXT.innerHTML = wrappedDATA.join('')
    } else { //VIEW SINGULAR MONTH.
        selector_TITLE_TXT.innerHTML =  `<span class="defaultTXT">${newSELECTORZ.join('')}</span>`
    } //END DYNAMIC SELECTOR BEHAVIOR
    let chartELEM = document.getElementById(`candlestickFRAME_${TGTtkr}`)
    init_DYNA_CHART_Candle(chartELEM);    //DYNA - init chart.
}
//*************************************************END DYNA SELECTOR***********
//***********************************SUB SELECTOR***********
function init_SUB_SELECTORS(tkr){ //assign click handlers
    let selectELEM = document.getElementById('CANDLE_SUB_SELECTOR_'+tkr)
    selectELEM.addEventListener("change", (event) => {SUB_SELECTOR_Change(event,tkr)}); 
}
function SUB_SELECTOR_Change(e,tkr){
    let chartELEM = document.getElementById(`candlestickFRAME_${tkr}`)
    init_DYNA_CHART_Candle(chartELEM);   
}
function getCandleSubSELECT(tgtTKR){
    let selectELEM = document.getElementById('CANDLE_SUB_SELECTOR_'+tgtTKR)
    return selectELEM.value;
}
//***********************************END SUB SELECTOR***********

//******DYNA CHART - BASELINE*****************************************
let DYNA_CHART_BASELINES = []; //for screen resize
function init_DYNA_CHART_Baseline(tgtELEM){
    const chartOptions = { width:300,height:100,  autoSize:true,
        layout: { textColor: 'white', background: { type: 'solid', color: 'black' } },
        grid: { vertLines: { color: "#222" }, horzLines: { color: "#282828" } }, 
    };
    tgtELEM.innerHTML='';
    let Dyna_Chart_Baseline = LightweightCharts.createChart(tgtELEM, chartOptions);
    const baselineSeries = Dyna_Chart_Baseline.addBaselineSeries({ baseValue: { type: 'price', price: 25 }, topLineColor: 'rgba( 38, 166, 154, 1)', topFillColor1: 'rgba( 38, 166, 154, 0.28)', topFillColor2: 'rgba( 38, 166, 154, 0.05)', bottomLineColor: 'rgba( 239, 83, 80, 1)', bottomFillColor1: 'rgba( 239, 83, 80, 0.05)', bottomFillColor2: 'rgba( 239, 83, 80, 0.28)' });
    const data = [{ value: 1, time: 1642425322 }, { value: 8, time: 1642511722 }, { value: 10, time: 1642598122 }, { value: 20, time: 1642684522 }, { value: 3, time: 1642770922 }, { value: 43, time: 1642857322 }, { value: 41, time: 1642943722 }, { value: 43, time: 1643030122 }, { value: 56, time: 1643116522 }, { value: 46, time: 1643202922 }];
    baselineSeries.setData(data);
    Dyna_Chart_Baseline.timeScale().fitContent();
    // resize_DYNA_CHART_Baseline(Dyna_Chart_Baseline);
    DYNA_CHART_BASELINES.push(Dyna_Chart_Baseline); //for screen resize    
}; //END INIT DYNA_CHART - baseline
// function resize_DYNA_CHART_Baseline(elem){
//     let frame = document.getElementsByClassName('dynamicBaseline')[0]
//     let maxWidth = (frame.offsetWidth>700)?700:(frame.offsetWidth<700)?frame.offsetWidth-40:frame.offsetWidth-60;//(frame.offsetWidth*0.1);
//     let maxHeight = 100;//(frame.offsetWidth>800)?600:frame.offsetWidth-200;  
//     if(maxWidth<100){return}
//     elem.resize(maxWidth, maxHeight);
// }; 
//*************************************************END DYNA-CHART BASELINE***********
//******************************SCREEN RESIZE - DYNA CHART***********
// window.addEventListener('resize', () => { //for SCREEN RESIZE - CANDLE CHARTS
//     for(var j=0; j<DYNA_CHART_CANDLES.length;j++){
//         tgtTKR = DYNA_CHART_CANDLES[j];
//         resize_DYNA_CHART_Candle(tgtTKR)
//     }  
//     for(var j=0; j<DYNA_CHART_BASELINES.length;j++){
//         tgtTKR = DYNA_CHART_BASELINES[j];
//         resize_DYNA_CHART_Baseline(tgtTKR)
//     }  
// });
//******************************SCREEN RESIZE - DYNA CHART***********
//*******GET DATA for - DYNA CHART***********
function getMarker_TRADE_DATA(aTKR){
    let tradeMarkerData = [];
    let monthlySELECTOR = bankbookz_DB.METASTATE.monthlySELECTORMap[aTKR];
    if(!monthlySELECTOR && aTKR){
        monthlySELECTOR = 'Last 33'; //DEFAULT
        bankbookz_DB.METASTATE.monthlySELECTORMap[aTKR]=monthlySELECTOR;
    }
    let candleSeriesSUBSELECT = getCandleSubSELECT(aTKR); //SUB SELECTORS - LOGIC.
    const selector_TITLE_TXT = document.getElementById(`candlestickTITLES_${aTKR}`);
    const currentSELECTORZ = selector_TITLE_TXT.children; //DATE/TIME SELECTORS.
    if(monthlySELECTOR==='Last 33'){ //Last 33 days of tickrs
        let ymtKEYS = Object.keys(bankbookz_DB.TRADE_TXNZ_YMT);
        let tradeSET=[],markerOBJ={},monthKEY,displayVal;
        let dayCNT = 0,tkrTAG,txnObj;
        ymtKEYS = sort_YMT_KEYS(ymtKEYS);
        ymtKEYS.reverse(); //oldest first.
        for(var i = 0; i< ymtKEYS.length && dayCNT<34; i++){ //Last 33 days
            monthKEY = ymtKEYS[i];
            tkrTAG = monthKEY.split("_")[2]
            if(tkrTAG!=aTKR){continue}
            tradeSET = bankbookz_DB.TRADE_TXNZ_YMT[monthKEY]
            for(var ii=0; ii<tradeSET.length;ii++){
                dayCNT++;
                if(dayCNT>33){break;}
                markerOBJ={};
                markerOBJ.time = tradeSET[ii].ymd.replace(/_/g,'-'); //for charts.
                if(candleSeriesSUBSELECT==="price"){
                    markerOBJ.value = parseFloat(tradeSET[ii].price.replace(/,/g,'') );
                }else{
                    markerOBJ.value = tradeSET[ii].amt;
                }
                // markerOBJ.value = tradeSET[ii].amt;
                // markerOBJ.position = "inBar";
                markerOBJ.color = (tradeSET[ii].type==='BUY')?"#2a2afc":"purple";
                // markerOBJ.color = (tradeSET[ii].type==='BUY')?"#219644":"#e91e63";
                markerOBJ.position = (tradeSET[ii].type==='BUY')?"belowBar":"aboveBar";
                displayVal = Math.trunc(markerOBJ.value)
                markerOBJ.text = `${displayVal}`;
                // markerOBJ.shape = "circle";
                // markerOBJ.size = 0.111;
                // markerOBJ.size = 0.444;
                tradeMarkerData.push(markerOBJ);
            }
        }  
        return tradeMarkerData;
    } else if (monthlySELECTOR==='All Time') { //load all data for tkrs.
        let ymtKEYS = Object.keys(bankbookz_DB.TRADE_TXNZ_YMT);
        let tradeSET=[],markerOBJ={},monthKEY,displayVal;
        let dayCNT = 0,tkrTAG,txnObj;
        ymtKEYS = sort_YMT_KEYS(ymtKEYS);
        ymtKEYS.reverse(); //oldest first.
        for(var i = 0; i< ymtKEYS.length; i++){ //ALL TIME data LOOP.
            monthKEY = ymtKEYS[i];
            tkrTAG = monthKEY.split("_")[2]
            if(tkrTAG!=aTKR){continue}
            tradeSET = bankbookz_DB.TRADE_TXNZ_YMT[monthKEY]
            for(var ii=0; ii<tradeSET.length;ii++){
                markerOBJ={};
                markerOBJ.time = tradeSET[ii].ymd.replace(/_/g,'-'); //for charts.
                if(candleSeriesSUBSELECT==="price"){
                    markerOBJ.value = parseFloat(tradeSET[ii].price.replace(/,/g,'') );
                }else{
                    markerOBJ.value = tradeSET[ii].amt;
                }                
                // markerOBJ.value = tradeSET[ii].amt;
                // markerOBJ.value = parseFloat(tradeSET[ii].price.replace(/,/g,'') );
                // markerOBJ.position = "inBar";
                markerOBJ.color = (tradeSET[ii].type==='BUY')?"#2a2afc":"purple";                    
                markerOBJ.position = (tradeSET[ii].type==='BUY')?"belowBar":"aboveBar";
                // markerOBJ.color = (tradeSET[ii].type==='BUY')?"#219644":"#e91e63";
                displayVal = Math.trunc(markerOBJ.value)
                markerOBJ.text = `${displayVal}`;
                // markerOBJ.shape = "circle";
                // markerOBJ.size = 0.111;
                tradeMarkerData.push(markerOBJ);
            }
        }  
        return tradeMarkerData; 
    }
    else if (currentSELECTORZ.length>1) {  //RETURN MULTIPLE MONTH MARKERS.
        let moTGT,tradeSET;
        // debugger;
        for(var i = 0; i< currentSELECTORZ.length; i++){ //multi month
            moTGT = currentSELECTORZ[i].innerText.split('\nx')[0];//trim delete btn
            tradeSET = bankbookz_DB.TRADE_TXNZ_YMT[moTGT];
            if(!tradeSET){console.log(`No Monthly Data ${moTGT}`); continue;}
            for(var ii=0; ii<tradeSET.length;ii++){ //MONTHLY TXN data LOOP.
                markerOBJ={};
                markerOBJ.time = tradeSET[ii].ymd.replace(/_/g,'-'); //for charts.
                markerOBJ.value = parseFloat(tradeSET[ii].price.replace(/,/g,'') );
                if(candleSeriesSUBSELECT==="price"){
                    markerOBJ.value = parseFloat(tradeSET[ii].price.replace(/,/g,'') );
                }else{
                    markerOBJ.value = tradeSET[ii].amt;
                }                
                // markerOBJ.value = tradeSET[ii].amt;
                // markerOBJ.value = parseFloat(tradeSET[ii].price.replace(/,/g,'') );
                // markerOBJ.position = "inBar";
                markerOBJ.color = (tradeSET[ii].type==='BUY')?"#2a2afc":"purple";
                markerOBJ.position = (tradeSET[ii].type==='BUY')?"belowBar":"aboveBar";
                // markerOBJ.color = (tradeSET[ii].type==='BUY')?"#219644":"#e91e63";
                displayVal = Math.trunc(markerOBJ.value)
                markerOBJ.text = `${displayVal}`;
                // markerOBJ.shape = "circle";
                // markerOBJ.size = 0.111;
                tradeMarkerData.push(markerOBJ);
            }            
        }
        return tradeMarkerData;
    } else if (monthlySELECTOR.indexOf('_')>-1) {  //RETURN SINGLE MONTH MARKERS.
        // debugger;
        let tradeSET = bankbookz_DB.TRADE_TXNZ_YMT[monthlySELECTOR];
        if(!tradeSET){console.log('No Monthly Data'); return [];}

        for(var ii=0; ii<tradeSET.length;ii++){ //MONTHLY TXN data LOOP.
            markerOBJ={};
            markerOBJ.time = tradeSET[ii].ymd.replace(/_/g,'-'); //for charts.
            if(candleSeriesSUBSELECT==="price"){
                    markerOBJ.value = parseFloat(tradeSET[ii].price.replace(/,/g,'') );
                }else{
                    markerOBJ.value = tradeSET[ii].amt;
                }            
            // markerOBJ.value = tradeSET[ii].amt;
            // markerOBJ.value = parseFloat(tradeSET[ii].price.replace(/,/g,'') );
            // markerOBJ.position = "inBar";
            markerOBJ.color = (tradeSET[ii].type==='BUY')?"#2a2afc":"purple";
            markerOBJ.position = (tradeSET[ii].type==='BUY')?"belowBar":"aboveBar";
            // markerOBJ.color = (tradeSET[ii].type==='BUY')?"#219644":"#e91e63";
            displayVal = Math.trunc(markerOBJ.value)
            markerOBJ.text = `${displayVal}`;
            // markerOBJ.shape = "circle";
            // markerOBJ.size = 0.111;
            tradeMarkerData.push(markerOBJ);
        }
        return tradeMarkerData;             
    } 
    return tradeMarkerData;
}
function getArea_TRADE_DATA(aTKR){
    let areaSeriesDATA = [];
    let monthlySELECTOR = bankbookz_DB.METASTATE.monthlySELECTORMap[aTKR];
    if(!monthlySELECTOR && aTKR){
        monthlySELECTOR = 'Last 33';
        bankbookz_DB.METASTATE.monthlySELECTORMap[aTKR]=monthlySELECTOR;
    }
    if(monthlySELECTOR==='Last 33'){ //Last 33 days of tickrs
        let ymtKEYS = Object.keys(bankbookz_DB.TRADE_TXNZ_YMT);
        let tradeSET=[],monthKEY;
        let dayCNT = 0,tkrTAG,txnObj;
        ymtKEYS.reverse(); //oldest first.
        for(var i = 0; i< ymtKEYS.length && dayCNT<34; i++){ //Last 33 days
            monthKEY = ymtKEYS[i];
            tkrTAG = monthKEY.split("_")[2]
            if(tkrTAG!=aTKR){continue}
            tradeSET = bankbookz_DB.TRADE_TXNZ_YMT[monthKEY]
            for(var ii=0; ii<tradeSET.length;ii++){
                dayCNT++;
                if(dayCNT>33){break;}
                tradeSET[ii].time = tradeSET[ii].ymd.replace(/_/g,'-'); //for charts.
                tradeSET[ii].value = parseFloat(tradeSET[ii].price.replace(/,/g,'') );
                areaSeriesDATA.push(tradeSET[ii]);
            }
        }  
    }else if (monthlySELECTOR==='All Time') { //load all data for tkrs.
        areaSeriesDATA = [
        { time: '2024-7-2', value: 66232.51 },{ time: '2024-7-3', value: 65331.11 },
        { time: '2024-7-4', value: 64227.02 },{ time: '2024-7-5', value: 64327.32 },
        { time: '2024-7-6', value: 65225.17 },{ time: '2024-7-7', value: 64328.89 },
        { time: '2024-7-8', value: 65225.46 },{ time: '2024-7-9', value: 66323.92 },
        { time: '2024-7-10', value: 67222.68 },{ time: '2024-7-11', value: 68322.67 },
    ]        
        // let ymtKEYS = Object.keys(bankbookz_DB.TRADE_TXNZ_YMT);
        // let txnSET=[],monthKEY,txnItem;
        // for(var i = 0; i< ymtKEYS.length; i++){ //all time
        //     monthKEY = ymtKEYS[i];
        //     tkrTAG = monthKEY.split("_")[2]
        //     if(tkrTAG!=aTKR){continue}
        //     txnSET = bankbookz_DB.TRADE_TXNZ_YMT[monthKEY]
        //     for(var ii=0; ii<txnSET.length;ii++){
        //         areaSeriesDATA.push(txnSET[ii]);
        //     }
        // }  
        // areaSeriesDATA.reverse();        
    }else {
        areaSeriesDATA = [
        { time: '2024-7-2', value: 66232.51 },{ time: '2024-7-3', value: 65331.11 },
        { time: '2024-7-4', value: 64227.02 },{ time: '2024-7-5', value: 64327.32 },
        { time: '2024-7-6', value: 65225.17 },{ time: '2024-7-7', value: 64328.89 },
        { time: '2024-7-8', value: 65225.46 },{ time: '2024-7-9', value: 66323.92 },
        { time: '2024-7-10', value: 67222.68 },{ time: '2024-7-11', value: 68322.67 },
    ]        
    }
    return areaSeriesDATA;    
}
function getCandleSeriesDATA(aTKR){
    let candleSeriesDATA = [];
    let tgtData = bankbookz_DB.TICKR_DATA_MAP_Monthly[aTKR];
    if(!tgtData){return candleSeriesDATA} //error trap no data
    let ymtKEYS = Object.keys(tgtData);
    if(!ymtKEYS.length){return candleSeriesDATA}
    let monthlySelectors = [];
    const selector_TITLE_TXT = document.getElementById(`candlestickTITLES_${aTKR}`);
    let monthlySELECTOR = '';
    if(!selector_TITLE_TXT || !selector_TITLE_TXT.innerText){
        bankbookz_DB.METASTATE.monthlySELECTORMap[aTKR]; //init default saved. 
    }else{ //init saved selection
        monthlySELECTOR = bankbookz_DB.METASTATE.monthlySELECTORMap[aTKR];
        monthlySelectors = Array(...selector_TITLE_TXT.children);
    }
    if(!monthlySELECTOR && aTKR){ //Default: LOAD LAST 33 DATA
        monthlySELECTOR = 'Last 33';
        bankbookz_DB.METASTATE.monthlySELECTORMap[aTKR]=monthlySELECTOR;
    }
    if(monthlySelectors.length>1){ //Multiple Month Load Logic.
        let ymtKey,revArr=[];
        for(var i=0; i<monthlySelectors.length;i++){
            ymtKey = monthlySelectors[i].innerText.split('\nx')[0];//trim deletebtn
            revArr = new Array(...bankbookz_DB.TICKR_DATA_MAP_Monthly[aTKR][ymtKey])
            revArr.reverse();
            candleSeriesDATA.push(...revArr)
        }
    }else if(monthlySELECTOR==='Last 33'){ //Last 33 days of tickrs
        // let ymtKEYS = Object.keys(bankbookz_DB.TICKR_DATA_MAP_Monthly[aTKR]);
        let txnSET=[],monthKEY,txnItem;
        let dayCNT = 0;
        ymtKEYS.reverse(); //Not LWC order DESC.
        for(var i = 0; i< ymtKEYS.length && dayCNT<34; i++){ //Last 33 days
            monthKEY = ymtKEYS[i];
            txnSET = bankbookz_DB.TICKR_DATA_MAP_Monthly[aTKR][monthKEY]
            for(var ii=0; ii<txnSET.length;ii++){
                dayCNT++;
                if(dayCNT>33){break;}
                candleSeriesDATA.push(txnSET[ii]);
            }
        }  
        candleSeriesDATA.reverse();
    }else if (monthlySELECTOR==='All Time') { //load all data for tkrs.
        // let ymtKEYS = Object.keys(bankbookz_DB.TICKR_DATA_MAP_Monthly[aTKR]);
        let txnSET=[],monthKEY,txnItem;
        for(var i = 0; i< ymtKEYS.length; i++){ //Last 33 days
            monthKEY = ymtKEYS[i];
            txnSET = bankbookz_DB.TICKR_DATA_MAP_Monthly[aTKR][monthKEY]
            for(var ii=0; ii<txnSET.length;ii++){
                candleSeriesDATA.push(txnSET[ii]);
            }
        }  
        candleSeriesDATA.reverse();        
    }else {
        console.log('SELECTED',monthlySELECTOR)
        candleSeriesDATA.push(...bankbookz_DB.TICKR_DATA_MAP_Monthly[aTKR][monthlySELECTOR]);
        candleSeriesDATA.reverse(); 
    }
    return candleSeriesDATA;
}
//*******END GET DATA for - DYNA CHART***********
//*******Delete selector for - DYNA CHART***********
function delete_SELECTOR_TXT(e){
    let TGTtkr = e.target.parentElement.parentElement.id.split('_')[1]
    const selector_TITLE_TXT = document.getElementById(`candlestickTITLES_${TGTtkr}`);
    let defaultTXT = selector_TITLE_TXT.children[0].innerText;
    selector_TITLE_TXT.innerHTML = `<span class="defaultTXT">${defaultTXT}</span>`
    //Reset combo selector
    let selectELEM = document.getElementById('DYNA_YMT_SELECTOR_'+TGTtkr)   
    selectELEM.value = defaultTXT;
    //Reset selector map.
    bankbookz_DB.METASTATE.monthlySELECTORMap[TGTtkr] = defaultTXT;
    //DYNA - init chart.
    let chartELEM = document.getElementById(`candlestickFRAME_${TGTtkr}`)
    init_DYNA_CHART_Candle(chartELEM);  
}
//*******END Delete selector for - DYNA CHART***********

</script><!--****************************END DYNAMIC CHART-->
<script  >// ****************************** XMPL CHART**********************
let CandlestickChart1;
function initCandleChart_XMPL(){
    const chartOptions = { width: 400, height: 300, 
        layout: { textColor: 'steelblue', background: { type: 'solid', color: '#000000' } },
        grid: { vertLines: { color: "#222" }, horzLines: { color: "#9090ff" } },
        crosshair: { mode: LightweightCharts.CrosshairMode.Normal ,
            vertLine: { color: "darkslategrey" },
            horzLine: { color: "darkslategrey" },
        },
        rightPriceScale:{visible:true,},leftPriceScale:{visible:true},
    }
    CandlestickChart1 = LightweightCharts.createChart(
        document.getElementById('candelstickFRAME_XMPL'), chartOptions);
    //AREA-SERIES******************************************************
    const areaSeries = CandlestickChart1.addAreaSeries({
        lineColor: '#2962FF', topColor: '#2962FF',
        bottomColor: 'rgba(41, 98, 255, 0.28)',layout: { textColor: 'steelblue', 
        background: { type: 'solid', color: '#000000' } } ,
        pointMarkersVisible:true, pointMarkersRadius:4
    });
    areaSeries.setData([
        { time: '2018-12-22', value: 232.51 },{ time: '2018-12-23', value: 331.11 },
        { time: '2018-12-24', value: 227.02 },{ time: '2018-12-25', value: 327.32 },
        { time: '2018-12-26', value: 225.17 },{ time: '2018-12-27', value: 328.89 },
        { time: '2018-12-28', value: 225.46 },{ time: '2018-12-29', value: 323.92 },
        { time: '2018-12-30', value: 222.68 },{ time: '2018-12-31', value: 322.67 },
    ]);
    //END: AREA-SERIES******************************************************        
    // CANDLESTICK-SERIES******************************************************        
    const candlestickSeries = CandlestickChart1.addCandlestickSeries({ //width: 600, height: 300, 
        priceScaleId: 'left',layout: { textColor: 'steelblue',autoSize:false,
        background: { type: 'solid', color: '#000000' } }  ,
        wickUpColor: "#26a69a",upColor: "#26a69a",wickDownColor: "rgb(225, 50, 85)",downColor: "rgb(225, 50, 85)",
    });
    candlestickSeries.setData([
        {time: '2018-12-22', open: 7511.16, high: 8211.84, low: 3611.16, close: 4511.72 },{time: '2018-12-23', open: 4511.12, high: 5311.90, low: 4511.12, close: 4811.09 },
        {time: '2018-12-24', open: 6011.71, high: 6011.71, low: 5311.39, close: 5911.29 },{time: '2018-12-25', open: 6811.26, high: 6811.26, low: 5911.04, close: 6011.50 },
        {time: '2018-12-26', open: 6711.71, high: 10511.85, low: 6611.67, close: 9111.04 },{time: '2018-12-27', open: 9111.04, high: 12111.40, low: 8211.70, close: 11111.40 },
        {time: '2018-12-28', open: 11111.51, high: 14211.83, low: 10311.34, close: 13111.25 },{time: '2018-12-29', open: 13111.33, high: 15111.17, low: 7711.68, close: 9611.43 },
        {time: '2018-12-30', open: 10611.33, high: 11011.20, low: 9011.39, close: 9811.10 },{time: '2018-12-31', open: 10911.87, high: 11411.69, low: 8511.66, close: 11111.26 },
    ]);
    CandlestickChart1.timeScale().fitContent();    
    resizeCandlestickChart1();
}; initCandleChart_XMPL();

function resizeCandlestickChart1(){
    let frame = document.getElementById('BOOK_VIEW');
    let maxWidth = (frame.offsetWidth>800)?700:(frame.offsetWidth<400)?frame.offsetWidth-40:frame.offsetWidth-80;//(frame.offsetWidth*0.1);
    let maxHeight = (frame.offsetWidth>800)?600:frame.offsetWidth-200;
    if(maxWidth<100 || maxHeight<50){return}
    CandlestickChart1.resize(maxWidth, maxHeight);
}
//*************************************************MAIN BASELINE CHART***********
let BaselineChart_XMPL;
function initBaselineChart_XMPL(){
    const chartOptions = {  width: 400, height: 300, autoSize:true,
        layout: { textColor: 'white', background: { type: 'solid', color: 'black' } },
        grid: { vertLines: { color: "#222" }, horzLines: { color: "#282828" } }, 
    };
    BaselineChart_XMPL = LightweightCharts.createChart(document.getElementById('baselineFRAME_XMPL'), chartOptions);
    const baselineSeries = BaselineChart_XMPL.addBaselineSeries({ baseValue: { type: 'price', price: 25 }, topLineColor: 'rgba( 38, 166, 154, 1)', topFillColor1: 'rgba( 38, 166, 154, 0.28)', topFillColor2: 'rgba( 38, 166, 154, 0.05)', bottomLineColor: 'rgba( 239, 83, 80, 1)', bottomFillColor1: 'rgba( 239, 83, 80, 0.05)', bottomFillColor2: 'rgba( 239, 83, 80, 0.28)' });
    const data = [{ value: 1, time: 1642425322 }, { value: 8, time: 1642511722 }, { value: 10, time: 1642598122 }, { value: 20, time: 1642684522 }, { value: 3, time: 1642770922 }, { value: 43, time: 1642857322 }, { value: 41, time: 1642943722 }, { value: 43, time: 1643030122 }, { value: 56, time: 1643116522 }, { value: 46, time: 1643202922 }];
    baselineSeries.setData(data);
    BaselineChart_XMPL.timeScale().fitContent();
}; initBaselineChart_XMPL(); 

// function resizeBaselineChart_XMPL(){
//     let frame = document.getElementById('baselineFRAME_XMPL');
//     let maxWidth = (frame.offsetWidth>800)?700:(frame.offsetWidth<400)?frame.offsetWidth-0:frame.offsetWidth-80;//(frame.offsetWidth*0.1);
//     let maxHeight = 100;//(frame.offsetWidth>800)?300:frame.offsetWidth-300;
//     if(maxWidth<100){return}
//     BaselineChart_XMPL.resize(maxWidth, maxHeight);
// }; resizeBaselineChart_XMPL();
//*************************************************END MAIN BASELINE CHART***********
//**EVENT-HANDLERS*****************************************************
// window.addEventListener('resize', () => {
    // resizeCandlestickChart1();
    // resizeBaselineChart_XMPL();
// });
//**END EVENT-HANDLERS*****************************************************
</script><!--****************************************END CHART IMPLEMENTATION-->
<script  > //*********************MAIN_APP**************************
// ******DATES *********************DATES*****************************
// const dateTXTStr = document.getElementById('dateTXTStamp');
// dateTXTStam.innerHTML = new Date().getFullYear();
const currentDate = new Date();
const yearNUM = currentDate.getFullYear();
const monthNUM = (currentDate.getMonth() + 1).toString();//.padStart(2, '0'); // Adding 1 because months are zero-indexed
const dayNUM = currentDate.getDate().toString();//.padStart(2, '0');
const current_ymd = `YMD_${yearNUM}_${monthNUM}_${dayNUM}`;
// **** END DATES *****************ENDDATES*********************************
const screenHeight = window.innerHeight;
// console.log("Screen Height:", screenHeight, "px");
// **** END HEIGHT *****************ENDHEIGHT*********************************
// **** VIEWS ********************************VIEWS***********************
const TCKR_VIEW = document.getElementById("TCKR_VIEW");
const BANK_VIEW = document.getElementById("BANK_VIEW");
const BOOK_VIEW = document.getElementById("BOOK_VIEW");
const DATA_VIEW = document.getElementById("DATA_VIEW");
const TCKR_VIEW_BTN = document.getElementById("TCKR_VIEW_BTN");
const BANK_VIEW_BTN = document.getElementById("BANK_VIEW_BTN");
const BOOK_VIEW_BTN = document.getElementById("BOOK_VIEW_BTN");
const DATA_VIEW_BTN = document.getElementById("DATA_VIEW_BTN");
const GALLERY_VIEW_BTN = document.getElementById("GALLERY_VIEW_BTN");
const IMPORT_VIEW_BTN = document.getElementById("IMPORT_VIEW_BTN");
const DATA_GALLERY_FRAME = document.getElementById("DATA_GALLERY_FRAME");
const DATA_TICKR_FRAME = document.getElementById("DATA_TICKR_FRAME");
const DATA_TRADE_FRAME = document.getElementById("DATA_TRADE_FRAME");
const DATA_IMPORT_FRAME = document.getElementById("DATA_IMPORT_FRAME");
const render_TICKR_GALLERY = document.getElementById("render_TICKR_GALLERY");
const render_EDIT_TICKR_Frame = document.getElementById("render_EDIT_TICKR_Frame");
const render_EDIT_TRADE_Frame = document.getElementById("render_EDIT_TRADE_Frame");
const tickr_SELECTOR_YMT = document.getElementById("tickr_SELECTOR_YMT");
const trade_SELECTOR_YMT = document.getElementById("trade_SELECTOR_YMT");
TCKR_VIEW.classList.add('hiddenTab')     //TAB SWITCH
BANK_VIEW.classList.add('hiddenTab')     //TAB SWITCH
DATA_VIEW.classList.add('hiddenTab')     //TAB SWITCH
BOOK_VIEW_BTN.classList.add('selectedMAINBTN') //TAB DEFAULT handle
BOOK_VIEW.classList.remove('hiddenTab') //TAB DEFAULT handle
DATA_GALLERY_FRAME.classList.remove('hiddenTab')     //TAB DEFAULT
load_GALLERY_FRAME_DATA();
DATA_TICKR_FRAME.classList.add('hiddenTab')     //TAB SWITCH
DATA_TRADE_FRAME.classList.add('hiddenTab')     //TAB SWITCH
DATA_IMPORT_FRAME.classList.add('hiddenTab')     //TAB SWITCH
let EDIT_YMT_RECORD_ID = ''; //persist record editing between views.
let CHART_SELECTIONS = []; //persist chart selections between views. 
let DATA_GALLERY_LIST = `hi there`; 
// ******************************************VIEW METHODS**********
function go_TICKR_VIEW(){ //TAB SWITCH
    remove_VIEW_SELECTED();
    TCKR_VIEW.classList.remove('hiddenTab');     
    TCKR_VIEW_BTN.classList.add('selectedMAINBTN');
    BANK_VIEW.classList.add('hiddenTab');
    BOOK_VIEW.classList.add('hiddenTab');
    DATA_VIEW.classList.add('hiddenTab');
    init_TKRZ_TABZ()
}
function go_BANK_VIEW(){
    remove_VIEW_SELECTED();
    TCKR_VIEW.classList.add('hiddenTab');     
    BANK_VIEW.classList.remove('hiddenTab');
    BANK_VIEW_BTN.classList.add('selectedMAINBTN');
    BOOK_VIEW.classList.add('hiddenTab');
    DATA_VIEW.classList.add('hiddenTab');  
    init_BANKZ_TABZ() 
}
function go_BOOK_VIEW(){
    remove_VIEW_SELECTED();
    TCKR_VIEW.classList.add('hiddenTab');     
    BANK_VIEW.classList.add('hiddenTab');
    BOOK_VIEW.classList.remove('hiddenTab');
    BOOK_VIEW_BTN.classList.add('selectedMAINBTN');
    DATA_VIEW.classList.add('hiddenTab'); 
    init_BOOKZ_TABZ();  
}
function go_DATA_VIEW(){
    remove_VIEW_SELECTED();
    TCKR_VIEW.classList.add('hiddenTab');     
    BANK_VIEW.classList.add('hiddenTab');
    BOOK_VIEW.classList.add('hiddenTab');
    DATA_VIEW.classList.remove('hiddenTab');
    DATA_VIEW_BTN.classList.add('selectedMAINBTN');
    showDataGalleryView('gallery')
}
function remove_VIEW_SELECTED(){
    TCKR_VIEW_BTN.classList.remove('selectedMAINBTN');     
    BANK_VIEW_BTN.classList.remove('selectedMAINBTN');
    BOOK_VIEW_BTN.classList.remove('selectedMAINBTN');
    DATA_VIEW_BTN.classList.remove('selectedMAINBTN');  
}
function remove_SUB_VIEW_SELECTED(){
    GALLERY_VIEW_BTN.classList.remove('selectedSUBBTN');     
    IMPORT_VIEW_BTN.classList.remove('selectedSUBBTN');
}
function showDataGalleryView(type){
    if(type==='gallery'){
        DATA_GALLERY_FRAME.classList.remove('hiddenTab');
        load_GALLERY_FRAME_DATA();     
        remove_SUB_VIEW_SELECTED();
        GALLERY_VIEW_BTN.classList.add('selectedSUBBTN')            
        DATA_IMPORT_FRAME.classList.add('hiddenTab')   
        DATA_TICKR_FRAME.classList.add('hiddenTab')     
        DATA_TRADE_FRAME.classList.add('hiddenTab')     
    }else if (type==='edittrade'){
        DATA_GALLERY_FRAME.classList.add('hiddenTab')     
        DATA_IMPORT_FRAME.classList.add('hiddenTab')  
        DATA_TICKR_FRAME.classList.add('hiddenTab')     
        DATA_TRADE_FRAME.classList.remove('hiddenTab')         
    }else if(type==='edittickr'){ 
        DATA_GALLERY_FRAME.classList.add('hiddenTab')     
        DATA_IMPORT_FRAME.classList.add('hiddenTab')    
        DATA_TICKR_FRAME.classList.remove('hiddenTab')     
        DATA_TRADE_FRAME.classList.add('hiddenTab')     
    }else if(type==='import'){ 
        DATA_GALLERY_FRAME.classList.add('hiddenTab')     
        DATA_TICKR_FRAME.classList.add('hiddenTab')     
        DATA_TRADE_FRAME.classList.add('hiddenTab')      
        DATA_IMPORT_FRAME.classList.remove('hiddenTab')    
        remove_SUB_VIEW_SELECTED();
        IMPORT_VIEW_BTN.classList.add('selectedSUBBTN')          
    }
}
function load_GALLERY_FRAME_DATA(){
    let tkrREC = {}, tkrINPUT, tkrROW, editBTN_TKR,editBTN_TRADE;
    render_TICKR_GALLERY.innerHTML=''; //blank out
    for(var i=0; i<bankbookz_DB.TICKR_LIST.length;i++){
        tkrREC = bankbookz_DB.TICKR_LIST[i];
        tkrINPUT = document.createElement('input')
        tkrINPUT.value = tkrREC.tkr;
        tkrINPUT.readOnly = true;
        // tkrINPUT.placeholder = "ticker";
        tkrINPUT.classList.add('tkrTXT_BOX')
        tkrROW = document.createElement('article')
        tkrROW.classList.add('tkrROWZ')
        tkrROW.appendChild(tkrINPUT)
        editBTN_TRADE = document.createElement('button')
        editBTN_TRADE.innerHTML = 'Edit TRADE'+'🎢';
        editBTN_TRADE.classList.add('blackBTN')
        editBTN_TRADE.addEventListener("click",(e)=>{ editDataClick(e,'TRADE') });
        tkrROW.appendChild(editBTN_TRADE)
        editBTN_TKR = document.createElement('button')
        editBTN_TKR.innerHTML = 'Edit TKR'+'🎪';
        editBTN_TKR.classList.add('blackBTN')
        editBTN_TKR.addEventListener("click",(e)=>{ editDataClick(e,'TKR') });
        tkrROW.appendChild(editBTN_TKR)        
        render_TICKR_GALLERY.appendChild(tkrROW)  
    }
}
function editDataClick(e, datatype){
    let datatgt = e.target.parentElement.children[0].value;
    if(datatype==='TKR'){
        showDataGalleryView('edittickr'); //show data panel.
        renderTICKRData(datatgt);
    }else if(datatype==='TRADE'){
        showDataGalleryView('edittrade'); //show data panel.
        renderTRADEData(datatgt);
    }
}
function renderTICKRData(datatgt){
    let txnSet = bankbookz_DB.TICKR_DATA_MAP_Monthly[datatgt]
    // txnSet = ensureOrderASC(txnSet)
    if(!txnSet || txnSet.length){return}
    let monthKEYS = Object.keys(txnSet);
    monthKEYS.reverse(); //DESC, for non LWC sort.
    // let monthKEYS = Object.keys(bankbookz_DB.TICKR_DATA_MAP_Monthly[datatgt]);
    let moKEY,txnSET=[],txnITEM,itemSTR,subMenu;
    render_EDIT_TICKR_Frame.innerText=''; //blank out
    let delBTN,minmaxBTN,tkrTXT,moROW,moBOX,moDATA,BTNBOX;
    let tkrTTL = document.createElement('header');
    tkrTTL.classList = 'tkrTTL';
    tkrTXT = document.createElement('span')
    tkrTXT.innerText = datatgt;
    tkrTXT.classList.add('tkrTXT_BOX')
    tkrTXT.style.margin='1em 0 1em 0';
    tkrTTL.appendChild(tkrTXT)  
    // delBTN = document.createElement('button')
    // delBTN.innerHTML = '🗑️'
    // delBTN.classList.add('blackBTN')
    // delBTN.style.margin='0 1em 0 0';
    // delBTN.addEventListener("click",(event)=>{ deleteTickerMaster(event) });
    // tkrTTL.appendChild(delBTN)  
    render_EDIT_TICKR_Frame.appendChild(tkrTTL)    
    for(var i=0; i<monthKEYS.length;i++){
        moKEY = monthKEYS[i];
        // txnSET = bankbookz_DB.TICKR_DATA_MAP_Monthly[datatgt][moKEY];
        moBOX = document.createElement('section')
        moBOX.classList.add('tkrMenuBox')
        moROW = document.createElement('article')
        moROW.classList.add('expanderROW')
        moROW.style.width = "100%";
        moROW.style.lineHeight = '0.444em';
        tkrTXT = document.createElement('span')
        tkrTXT.innerText = moKEY;
        tkrTXT.style.margin='0.333em 0 0 0.444em';
        moROW.appendChild(tkrTXT)          
        BTNBOX = document.createElement('aside')
        BTNBOX.classList.add('BTNBOX')
        minmaxBTN = document.createElement('button')
        minmaxBTN.classList.add('expanderBTN')
        minmaxBTN.innerText = '✴';//'✧'
        minmaxBTN.classList.add('blackBTN')
        minmaxBTN.addEventListener("click",(event)=>{ MINMAX_SubList(event) });
        BTNBOX.appendChild(minmaxBTN) 
        delBTN = document.createElement('button')
        delBTN.innerHTML = '🗑️'
        delBTN.classList.add('blackBTN')
        delBTN.addEventListener("click",(event)=>{ deleteTickerSubList(event) });
        BTNBOX.appendChild(delBTN)                    
        moROW.appendChild(BTNBOX)                    
        moBOX.appendChild(moROW) 
        tkrDataFrame = document.createElement('section')
        tkrDataFrame.id = `tkrDataFrame_${datatgt}_${moKEY}`;
        tkrDataFrame.classList.add('tkrSubMenu')
        tkrDataFrame.style.display = 'none' 
        // *******************************POPULATE DATAFRAME    
        subMenu = getSubMenu_TKRTXTArea(datatgt,moKEY);
        // tkrDataFrame.innerHTML = subMenu;//(subMenu.length)?subMenu:'No Data.'   
        tkrDataFrame.appendChild(subMenu);//(subMenu.length)?subMenu:'No Data.'   
        // *******************************END DATAFRAME       
        moBOX.appendChild(tkrDataFrame)
        render_EDIT_TICKR_Frame.appendChild(moBOX)  
    }
}
function renderTRADEData(datatgt){
    let txnYMTs = bankbookz_DB.TRADE_TXNZ_YMT;
    let monthKEYS = Object.keys(txnYMTs);
    let moKEY,tkr,tradeMonthData=[],txnSET=[],txnITEM,itemSTR,subMenu;
    // ************************************TOP LINE************
    render_EDIT_TRADE_Frame.innerText=''; //blank out
    let delBTN,minmaxBTN,tkrTXT,moROW,moBOX,moDATA,BTNBOX;
    let tkrTTL = document.createElement('header');
    tkrTTL.classList = 'tkrTTL';
    tkrTXT = document.createElement('span')
    tkrTXT.innerText = datatgt;
    tkrTXT.classList.add('tkrTXT_BOX')
    tkrTXT.style.margin='1em 0 1em 0';
    tkrTTL.appendChild(tkrTXT)  
    // delBTN = document.createElement('button')
    // delBTN.innerHTML = '🗑️'
    // delBTN.classList.add('blackBTN')
    // delBTN.style.margin='0 1em 0 0';
    // delBTN.addEventListener("click",(event)=>{ deleteTradeMaster(event) });
    // tkrTTL.appendChild(delBTN)  
    render_EDIT_TRADE_Frame.appendChild(tkrTTL)    
    // ************************************END TOP LINE*****
    for(var i=0; i<monthKEYS.length;i++){
        moKEY = monthKEYS[i];
        tkr = moKEY.split('_')[2]
        if(datatgt!=tkr){continue}
        moBOX = document.createElement('section')
        moBOX.classList.add('tkrMenuBox')
        moBOX.style.border = '1px solid purple'
        moROW = document.createElement('article')
        moROW.classList.add('expanderROW')
        moROW.style.width = "100%";
        moROW.style.lineHeight = '0.444em';
        tkrTXT = document.createElement('span')
        tkrTXT.innerText = moKEY;
        tkrTXT.style.margin='0.333em 0 0 0.444em';
        moROW.appendChild(tkrTXT)          
        BTNBOX = document.createElement('aside')
        BTNBOX.classList.add('BTNBOX')
        minmaxBTN = document.createElement('button')
        minmaxBTN.classList.add('expanderBTN')
        minmaxBTN.innerText = '✴';//'✧'
        minmaxBTN.classList.add('blackBTN')
        minmaxBTN.addEventListener("click",(event)=>{ MINMAX_SubList(event) });
        BTNBOX.appendChild(minmaxBTN) 
        delBTN = document.createElement('button')
        delBTN.innerHTML = '🗑️'
        delBTN.classList.add('blackBTN')
        delBTN.addEventListener("click",(event)=>{ deleteTradeSubList(event) });
        BTNBOX.appendChild(delBTN)                    
        moROW.appendChild(BTNBOX)                    
        moBOX.appendChild(moROW) 
        tradeDataFrame = document.createElement('section')
        tradeDataFrame.id = `tradeDataFrame_${datatgt}_${moKEY}`;
        tradeDataFrame.classList.add('tkrSubMenu')
        tradeDataFrame.style.display = 'none' 
        // *******************************POPULATE DATAFRAME    
        subMenu = getSubMenu_TRADETXTArea(datatgt,moKEY);
        tradeDataFrame.appendChild(subMenu);  
        // *******************************END DATAFRAME          
        moBOX.appendChild(tradeDataFrame)
        render_EDIT_TRADE_Frame.appendChild(moBOX)  
    }
}
//--------------------------------------END DATA fns----------------------------------
//---------------------------------IMPORT fns----------------------------------
// let save_TradeClick = ()=>{
//     save_BANKBOOKZ_DB();
//     show_USERMSG({txt:'Saved!',icon:'🎇',time:2000});
    // let render_EDIT_TRADE_Frame = document.getElementById('render_EDIT_TRADE_Frame');
    //     let YMT_id, ymdSTR,clearTRADEMap={'YMT_id':true};
    //     let inputSTR = render_EDIT_TRADE_Frame.value, inputARR=[], tradeObj={};
    //     inputSTR = inputSTR.replace(/#(.*?)--->/g, '').replace(/\n/g,'').replace(/}{/g,'},{')
    //     try {
    //         inputARR = JSON.parse('['+inputSTR+']');
    //         //INPUT DATA: for each TXN, find tkr, find YMT, blank out, add.
    //         for(var i=0; i<inputARR.length;i++){
    //             tradeObj = inputARR[i];
    //             YMT_id = tradeObj.ymtID;
    //             if(!clearTRADEMap[YMT_id]){ //clear MONTH data for OVERRIDE
    //                 clearTRADEMap[YMT_id] = true; //clear out MONTH... system.
    //                 bankbookz_DB.TRADE_TXNZ_YMT[YMT_id] = []
    //             }
    //             bankbookz_DB.TRADE_TXNZ_YMT[YMT_id].push(tradeObj);
    //         }
    //         debugger;
    //         // save_BANKBOOKZ_DB();
    //     } catch (error) {console.log('ERR: Bad data.');}// go_DATA_VIEW(); } //todo msg
    // } //END  CLICK

    // function save_TickerClick(){
    //     save_BANKBOOKZ_DB();
    //     show_USERMSG({txt:'Saved!',icon:'🎇',time:2000});
        // let render_EDIT_TICKR_Frame = document.getElementById('render_EDIT_TICKR_Frame');
        // let tkrSTR, YMT_id, ymdSTR,clearDataMap={'YMT_id':true};
        // let inputSTR = render_EDIT_TICKR_Frame.innerHTML;
        // let inputARR=[], tkrObj={};
        // debugger;
        // return;
        // inputSTR = inputSTR.replace(/#(.*?)--->/g, '').replace(/\n/g,'').replace(/}{/g,'},{')
        // try {
        //     inputARR = JSON.parse('['+inputSTR+']');
        //     //INPUT DATA: for each TXN, find tkr, find YMT, blank out, add.
        //     for(var i=0; i<inputARR.length;i++){
        //         tkrObj = inputARR[i];
        //         tkrSTR = tkrObj.tkr;
        //         ymdARR = tkrObj.time.split("-")
        //         YMT_id = ymdARR[0]+"_"+ymdARR[1]+"_"+tkrSTR;
        //         if(!clearDataMap[YMT_id]){ //clear MONTH data for OVERRIDE
        //             clearDataMap[YMT_id] = true;
        //             bankbookz_DB.TICKR_DATA_MAP_Monthly[tkrSTR][YMT_id] = [];
        //         }
        //         bankbookz_DB.TICKR_DATA_MAP_Monthly[tkrSTR][YMT_id].push(tkrObj)
        //     }
        //     debugger;
        //     // save_BANKBOOKZ_DB();
        // } catch (error) {console.log('ERR: Bad data.'); go_DATA_VIEW(); }
    // }
function import_TradeClick(){
    let render_TRADE_IMPORT = document.getElementById('render_TRADE_IMPORT');
    let tkrSTR, YMT_id, txnSET=[],txnItem, dupeCNT=0, newCNT=0,txnFound=false;//, ymdSTR,clearDataMap={'YMT_id':true};
    let inputSTR = render_TRADE_IMPORT.value, inputARR=[], txnOBJ={};
    let trackItem, trackedItem=false,untrackedCNT=0;
    try {
        inputARR = JSON.parse(inputSTR);
        for(var i=0; i<inputARR.length;i++){
            txnOBJ = inputARR[i];
            tkrSTR = txnOBJ.tkr;
            // CHECK TRACKED or UNTRACKED
            trackedItem=false;
            for(var f=0; f< bankbookz_DB.TICKR_LIST.length;f++){
                trackItem = bankbookz_DB.TICKR_LIST[f];
                console.log(trackItem.tkr)
                if( trackItem.tkr===tkrSTR ) { //TRACKED ITEM
                    trackedItem=true;
                    untrackedCNT++;
                    break;
                }
            }
            if(!trackedItem){continue;} //SKIP UNTRACKED DATA
            YMT_id = txnOBJ.ymtID;
            debugger;
            YMT_id = ensurePaddedYMT(YMT_id);
            txnSET = bankbookz_DB.TRADE_TXNZ_YMT[YMT_id];
            if(!txnSET){ //CREATE NEW MONTH (trade)
                bankbookz_DB.TRADE_TXNZ_YMT[YMT_id] = [];
                txnSET = bankbookz_DB.TRADE_TXNZ_YMT[YMT_id]
            } 
            txnFound=false;
            for(var ii=0;ii<txnSET.length;ii++){ // CHECK FOR DUPLICATE TRADE TRANSACTIONS.
                txnItem = txnSET[ii];
                if (txnItem.ymtID===txnOBJ.ymtID && txnItem.price===txnOBJ.price && txnItem.shares===txnOBJ.shares)
                { //DUPLICATE RECORD - SKIP.
                    dupeCNT++;
                    txnFound=true;
                    break;
                } 
            }
            if(!txnFound){ //NEW RECORD
                newCNT++;
                bankbookz_DB.TRADE_TXNZ_YMT[YMT_id].push(txnOBJ);
            }
        }
        console.log(`IMPORTS; NEW recs:${newCNT}, SKIP Dupes:${dupeCNT}, `) 
        console.log(`Untracked transactions: ${untrackedCNT}`)
        let default_DATA = JSON.stringify(bankbookz_DB.TRADE_TXNZ_YMT);//COPY TO default_data : default_TRADE_DATA_MAP_Monthly
        // debugger;
        show_USERMSG({txt:'Data Imported',icon:'🛠️',time:2000});
        save_BANKBOOKZ_DB();
    } catch (error) {console.log('ERR: Bad data.'); go_DATA_VIEW(); }
}

</script><!--*******************************END VIEW structure LOGIC-->
<script  >  //********TAB VIEW LOGIC**************************
//*********************TICKRZ-LOGIC**********************/
const init_TKRZ_TABZ = ()=>{
    let tkrREC = {}, tkrINPUT, tkrROW;
    let TKR_RENDER_FRAME = document.getElementById('TKR_RENDER_FRAME');
    TKR_RENDER_FRAME.innerHTML=''; //blank out
    for(var i=0; i<bankbookz_DB.TICKR_LIST.length;i++){
        tkrREC = bankbookz_DB.TICKR_LIST[i];
        tkrINPUT = document.createElement('input')
        tkrINPUT.value = tkrREC.tkr;
        tkrINPUT.readOnly = false;
        tkrINPUT.placeholder = "ticker";
        tkrINPUT.classList.add('tkrTXT_BOX')
        // tkrINPUT.style.margin='1em 0 1em 0';
        tkrROW = document.createElement('article')
        tkrROW.classList.add('tkrROWZ')
        tkrROW.appendChild(tkrINPUT)
        delBTN = document.createElement('button')
        delBTN.innerHTML = '🗑️'
        delBTN.classList.add('blackBTN')
        delBTN.addEventListener("click",(event)=>{ deleteTickerClick(event) });
        tkrROW.appendChild(delBTN)
        TKR_RENDER_FRAME.appendChild(tkrROW)  
    }
}
const add_TKRZ_Click = ()=>{
    let tkrREC = {}, tkrINPUT, tkrROW;    
    let TKR_RENDER_FRAME = document.getElementById('TKR_RENDER_FRAME');
    tkrINPUT = document.createElement('input')
    tkrINPUT.value = 'NEW';
    tkrINPUT.readOnly = false;
    tkrINPUT.classList.add('tkrTXT_BOX')
    tkrROW = document.createElement('article')
    tkrROW.classList.add('tkrROWZ')
    tkrROW.appendChild(tkrINPUT)
    saveBTN = document.createElement('button')
    saveBTN.innerHTML = 'save🌟'
    saveBTN.classList.add('blackBTN')
    saveBTN.addEventListener("click",(event)=>{ saveTickerClick(event) });
    tkrROW.appendChild(saveBTN)
    TKR_RENDER_FRAME.appendChild(tkrROW)      
}
//*********************BANKZ- TAB - LOGIC**********************/
const init_BANKZ_TABZ = ()=>{
    //combo1
    let tkrREC = {}, tkrINPUT, tkrBOX, minmaxBTN,marginDataFrame,subMenu,tkrTTL;
    let MARGINZ_RENDER_FRAME = document.getElementById('MARGINZ_RENDER_FRAME');
    MARGINZ_RENDER_FRAME.innerHTML=''; //blank out
    for(var i=0; i<bankbookz_DB.TICKR_LIST.length;i++){
        tkrREC = bankbookz_DB.TICKR_LIST[i];
        tkrTTL = document.createElement('header')
        tkrTTL.classList = 'tkrTTL';
        tkrINPUT = document.createElement('input')
        tkrINPUT.value = tkrREC.tkr;
        tkrINPUT.readOnly = false;
        tkrINPUT.placeholder = "ticker";
        tkrINPUT.classList.add('tkrTXT_BOX')
        tkrINPUT.style.margin='1em 0 1em 0';
        tkrTTL.appendChild(tkrINPUT)
        tkrBOX = document.createElement('article')
        tkrBOX.classList.add('tkrSubBox')
        tkrBOX.classList.add('expanderROW')
        minmaxBTN = document.createElement('button')
        minmaxBTN.classList.add('expanderBTN')
        minmaxBTN.innerText = '✴';//'✧'
        minmaxBTN.classList.add('blackBTN')
        minmaxBTN.style.paddingLeft = '0.222em'
        minmaxBTN.addEventListener("click",(event)=>{ MINMAX_Menu(event) });
        tkrTTL.appendChild(minmaxBTN)
        marginDataFrame = document.createElement('section')
        marginDataFrame.id = `marginDataFrame_${tkrREC.tkr}`;
        marginDataFrame.classList.add('tkrSubMenu')
        marginDataFrame.style.display = 'none'
        subMenu = getSubMenu_MarginView(tkrREC.tkr);
        marginDataFrame.innerHTML = (subMenu.length)?subMenu:'No Data.'
        tkrBOX.appendChild(tkrTTL)
        tkrBOX.appendChild(marginDataFrame)
        MARGINZ_RENDER_FRAME.appendChild(tkrBOX)  
    }
}
//*********************END BANKZ- TAB - LOGIC**********************/
</script><!--*******************************END VIEW structure LOGIC-->
<script  >  //*********************BOOKZ-LOGIC**********************/
//*********************BOOKZ- TAB - LOGIC**********************/
const init_BOOKZ_TABZ = ()=>{
    let BOOKZ_RENDER_FRAME = document.getElementById('BOOKZ_RENDER_FRAME');
    BOOKZ_RENDER_FRAME.innerHTML=''; //blank out
    let bookFrame_Model = ``, tgtTKR={};
    for(var i=0; i< bankbookz_DB.TICKR_LIST.length; i++){
        tgtTKR = bankbookz_DB.TICKR_LIST[i];
        bookFrame_Model = `
        <section id="BOOKFRAME_${tgtTKR.tkr}" class="BOOKFRAME_Item">
                <header class="mainTitle expanderROW">
                    <span>${tgtTKR.tkr}</span>
                    <span class="expanderBTN" style="font-size:0.777em;" onclick="expander_BOOKZ_Click(event)">✧</span>
                </header>
            <menu style="display: flex;margin-right:3.333%;padding-left:2.222%;align-items: center;margin-bottom: 0.555em;">
                <article id="candlestickTITLES_${tgtTKR.tkr}" 
                    style="justify-content:flex-start;flex:1; display:flex;flex-wrap: wrap;
                    width:98%;padding:0 0.444em 0 0.444em;color: limegreen;"></article>
                <span>
                        <select id="DYNA_YMT_SELECTOR_${tgtTKR.tkr}"" class="chartSELECTOR">
                            <option value="true" selected>Last 33</option>
                        </select>
                    </span>
            </menu>
            <section id="candlestickBOX_${tgtTKR.tkr}" style="justify-content:center;
                display:flex;border:solid 1px steelblue;border-radius:22.222px;margin: 0 0 0.222em 0;
                flex-direction: column;padding: 0.222em 0.888em 0.222em 0.888em;">
                <header class="expanderROW">
                    <span class="expanderTITLE">Candles:</span>
                    <span class="expanderBTN" onclick="MINMAX(event.target)">✧</span>
                </header>
                <article id="candlestickFRAME_${tgtTKR.tkr}" class="dynamicCandleStick" style="justify-content:center;
                    flex:1; display:flex;border:solid 1px steelblue;border-radius:22.222px;">
                    <i style="font-size:0.555em;margin:0.888em;">No data.</i>
                </article>
                <menu style="justify-content: space-evenly; border-radius: 13px;display: flex; 
                    margin-top: 0;padding: 1em 0 0 0;">
                    <span><div style="background:blue;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                        margin-right: 0.5em;"></div>
                        <span style="font-size:0.666em;color:royalblue">BUY</span>
                    </span>
                    <span><div style="background:purple;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                        margin-right: 0.5em;"></div>
                        <span style="font-size:0.666em;color:rebeccapurple">SELL</span>
                    </span>
                    <span>
                        <select id="CANDLE_SUB_SELECTOR_${tgtTKR.tkr}" class="subSELECTOR">
                            <option value="amt">amt</option>
                            <option value="price">price</option>
                            <option value="struct">struct</option>
                        </select>
                    </span>
                </menu>
            </section>
            <section id="trendsBOX_${tgtTKR.tkr}" style="justify-content:center;
                display:flex;border:solid 1px steelblue;border-radius:22.222px;margin:0.222em 0 0.222em 0;
                flex-direction: column;padding: 0.222em 0.888em 0.222em 0.888em;">
                <header class="expanderROW">
                    <span class="expanderTITLE">Trends:</span>
                    <span class="expanderBTN" onclick="MINMAX(event.target)">✴</span>
                </header>
                <section style="display:none;flex-direction: column;">
                    <article id="trendzFRAME_${tgtTKR.tkr}" class="dynamicTrends" style="justify-content:center;
                        flex:1; display:flex;border:solid 1px steelblue;border-radius:22.222px;">
                        <i style="font-size:0.555em;margin:0.888em;">No data.</i>
                    </article>

                    <menu style="justify-content: center;border-radius: 13px; display: flex; margin-top: 0;
                        padding: 1em 0 0 0; height: 4em; flex-wrap: wrap; ">
                        <input type="checkbox" class="Trendz_CHECKBOX" id="linez_opt_${tgtTKR.tkr}">
                        <label for="linez_opt">linez</label>
                        <input type="checkbox" class="Trendz_CHECKBOX" id="candlez_opt_${tgtTKR.tkr}">
                        <label for="candlez_opt">candlez</label>
                        <input type="checkbox" class="Trendz_CHECKBOX" id="avgz_opt_${tgtTKR.tkr}">
                        <label for="avgz_opt">avgz</label>
                        <input type="checkbox" class="Trendz_CHECKBOX" id="volz_opt_${tgtTKR.tkr}">
                        <label for="volz_opt">volz</label>
                        <input type="checkbox" class="Trendz_CHECKBOX" id="3dz_opt_${tgtTKR.tkr}">
                        <label for="3dz_opt">3dz</label>
                        <input type="checkbox" class="Trendz_CHECKBOX" id="greenband_opt_${tgtTKR.tkr}">
                        <label for="greenband_opt">gband</label>
                        <input type="checkbox" class="Trendz_CHECKBOX" id="bollz_opt_${tgtTKR.tkr}">
                        <label for="bollz_opt">boll's</label>
                        <input type="checkbox" class="Trendz_CHECKBOX" id="cci_opt_${tgtTKR.tkr}">
                        <label for="cci_opt">cci</label>
                        <input type="checkbox" class="Trendz_CHECKBOX" id="mom_opt_${tgtTKR.tkr}">
                        <label for="mom_opt">mom</label>
                    </menu>

                    <menu style="justify-content: space-evenly; border-radius: 13px;display: flex; 
                        margin-top: 0;padding: 1em 0 0 0;">
                        <span><div style="background:blue;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                            margin-right: 0.5em;"></div>
                            <span style="font-size:0.666em;color:royalblue">BUY</span>
                        </span>
                        <span><div style="background:purple;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                            margin-right: 0.5em;"></div>
                            <span style="font-size:0.666em;color:rebeccapurple">SELL</span>
                        </span>
                    </menu>
                </section>
            </section>
            <section id="structsBOX_${tgtTKR.tkr}" style="justify-content:center;
                display:flex;border:solid 1px steelblue;border-radius:22.222px;margin:0.222em 0 0.222em 0;
                flex-direction: column;padding: 0.222em 0.888em 0.222em 0.888em;">
                <header class="expanderROW">
                    <span class="expanderTITLE">Draw:</span>
                    <span class="expanderBTN" onclick="MINMAX(event.target)">✴</span>
                </header>
                <section style="display:none;flex-direction: column;">
                    <article id="structsFRAME_${tgtTKR.tkr}" class="dynamicTrends" style="justify-content:center;
                        flex:1; display:flex;border:solid 1px steelblue;border-radius:22.222px;">
                        <i style="font-size:0.555em;margin:0.888em;">No data.</i>
                    </article>
                    <menu style="justify-content: space-evenly; border-radius: 13px;display: flex; 
                        <span><div style="background:blue;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                        margin-right: 0.5em;"></div>
                        <span style="font-size:0.666em;color:royalblue">BUY</span>
                        </span>
                        <span><div style="background:purple;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                            margin-right: 0.5em;"></div>
                            <span style="font-size:0.666em;color:rebeccapurple">SELL</span>
                        </span>
                    </menu>
                </section>
            </section>

            <section style="justify-content: center;margin-top:1em;flex-direction: column; padding:0 2% 0 2%;
            border-radius:22.222px;  display:flex;border:solid 1px teal;padding: 0.222em 0.888em 0.222em 0.888em;
            margin: 0.222em 0 0.222em 0;">
                <header class="expanderROW">
                    <span class="expanderTITLE">PnL:</span>
                    <span class="expanderBTN" onclick="MINMAX(event.target)">✴</span>
                </header>
                <section style="display:none; flex-direction:column;">
                    <article id="baselineFRAME_${tgtTKR.tkr}" class="dynamicBaseline" style="display:flex;justify-content:center;flex:1;">
                    </article>
                    <footer style="font-size:0.888em;margin-bottom:1em;display:flex;
                        justify-content:space-between; padding: 0em 3em 0 2em">
                        <span>
                            <div style="background:#26a69a;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                            margin-right: 0.5em;"></div>
                            <span style="font-size:0.666em;">BANK:</span>
                            <span style="font-size:0.666em;">444</span>
                        </span>                        
                        <span>
                            <div style="background:#26a69a;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                            margin-right: 0.5em;"></div>
                            <span style="font-size:0.666em;">BOOK:</span>
                            <span style="font-size:0.666em;">1,234</span>
                        </span>
                        <span>
                            <div style="background:#26a69a;border-radius:100%;border:solid 1px steelblue;height:0.5em;width:0.5em;display: inline-block;
                            margin-right: 0.5em;"></div>                        
                            <span style="font-size:0.666em;margin-top: 0.333em;color:steelblue">NET(PnL):</span>
                            <span style="font-size:0.666em;">234</span>
                        </span>
                    </footer>                  
                </section>            
            </section> 

            <menu id="dataFRAME_${tgtTKR.tkr}" class="FRAME" 
            style="justify-content: center;border: 1px solid purple;
    margin: 0.222em 0 0.222em 0;padding: 0.222em 0.888em 0.222em 0.888em; box-shadow: 1px 1px 8px purple;
                border-radius: 22.222px; display:flex;flex-direction: column;">
                <header class="expanderROW">
                    <span class="expanderTITLE">METADATA:</span>
                    <span class="expanderBTN" onclick="MINMAX(event.target)">✴</span>
                </header>
                <section style="display:none;">...</section>
            </menu>

        </section><!--end BOOKFRAME-->         
        `;
        BOOKZ_RENDER_FRAME.innerHTML += bookFrame_Model; 
    }//END BUILD LOOP
    init_BOOKZ_EXPANDER();
    setTimeout(render_ALL_BOOKZ_CHARTZ,222);
    setTimeout(render_ALL_DYNA_SELECTORZ,222);

};init_BOOKZ_TABZ();
function render_ALL_BOOKZ_CHARTZ(){
    let tgt_Candle,tgtTKR; //Render all CANDLESTICK DYNA_CHARTZ
    const All_DynaCandles = document.getElementsByClassName('dynamicCandleStick')
    DYNA_CHART_CANDLES = []; //blank out. for screen resize
    for(var i=0; i<All_DynaCandles.length;i++){
        tgt_Candle = All_DynaCandles[i];
        init_DYNA_CHART_Candle(tgt_Candle);
    }
    // let tgt_Baseline; //Render all BASELINE DYNA_CHARTZ
    // const All_Dynabaselines = document.getElementsByClassName('dynamicBaseline')
    // DYNA_CHART_BASELINES = []; //blank out. for screen resize
    // for(var j=0; j<All_Dynabaselines.length;j++){
    //     tgt_Baseline = All_Dynabaselines[j];
    //     init_DYNA_CHART_Baseline(tgt_Baseline);
    // }  
}
function render_ALL_DYNA_SELECTORZ(){
    let tgtTKR;
    for(var k=0; k<bankbookz_DB.TICKR_LIST.length;k++){
        tgtTKR = bankbookz_DB.TICKR_LIST[k].tkr;
        init_DYNA_SELECTOR(tgtTKR); //Put YMT into Combo & click.
        init_SUB_SELECTORS(tgtTKR); //assign click handlers.
    }   
}
function init_BOOKZ_EXPANDER(){ //collapse all BOOKZ except expanded tabs in local storage,
    let tgtTKR='',viewTKR='',viewID='',expanded=false, tgtBTN;
    const allBookz = document.getElementsByClassName('BOOKFRAME_Item');
    for(var j=0; j<allBookz.length;j++){ //collapse all except selected.
        viewID = viewTKR=allBookz[j].id;
        if(!viewID){continue}
        viewID = viewID.split('_')[1]
        if(!viewID){continue}
        expanded = false;
        for(var i=0; i<bankbookz_DB.METASTATE.BOOKZ_EXPANDER.length;i++){
            tgtTKR=bankbookz_DB.METASTATE.BOOKZ_EXPANDER[i];
            if(viewID===tgtTKR){ expanded = true; break; }
        }
        tgtBTN = allBookz[j].children[0].children[1];
        if(expanded){
            MINMAX(tgtBTN,expanded);
        }else if(!expanded){
            MINMAX(tgtBTN,expanded);
        }
    }
}; 
function expander_BOOKZ_Click(e){
    let TGT = e.target;
    MINMAX(TGT);
    saveBookSelection(TGT);
    let CURR_STATE = TGT.innerHTML;
    if(CURR_STATE!='✴'){//only load on expand (collapse icon)
        let viewID = TGT.parentElement.parentElement.id;
        let viewTKR = viewID.split('_')[1];    
    }
}
//***********************************************************SAVE-BTNS********
function saveBookSelection(TGT){
    let CURR_STATE = TGT.innerHTML;
    let viewID = TGT.parentElement.parentElement.id;
    let viewTKR = viewID.split('_')[1];
    let lookupIDX = bankbookz_DB.METASTATE.BOOKZ_EXPANDER.indexOf(viewTKR)
    if(CURR_STATE==='✴'){ //add singular to BOOKZ_EXPANDER
        if(lookupIDX>-1){
            bankbookz_DB.METASTATE.BOOKZ_EXPANDER.splice(lookupIDX,1)
            save_BANKBOOKZ_DB();
        }
    }else{ //remove from BOOKZ_EXPANDER.
        if(lookupIDX<0){
            bankbookz_DB.METASTATE.BOOKZ_EXPANDER.push(viewTKR)
            save_BANKBOOKZ_DB();
        }
    }
}
function saveTickerClick(e){
    let userTKR = e.target.previousElementSibling.value;
    userTKR = userTKR.toUpperCase();
    if(userTKR==='NEW'){return}
    let item;
    for(var i=0;i<bankbookz_DB.TICKR_LIST.length;i++){
        item = bankbookz_DB.TICKR_LIST[i];
        if(userTKR===item.tkr){ 
            return; //duplicate TKR
        }
    }
    bankbookz_DB.TICKR_LIST.push({tkr:userTKR, lastLoadYMD: ''})
    save_BANKBOOKZ_DB();
    init_TKRZ_TABZ();
}
//**************************************************ENDSAVE BTNS****************
//********************************DELETE BTNS*********************************
function deleteTickerMaster(e){ debugger;}
function deleteTickerSubList(e){
    // debugger;
    let moYMT = e.target.parentElement.previousElementSibling.innerText
    if(!moYMT){return}
    let tkr = moYMT.split('_')[2];
    if(!tkr){return}
    let dataSet = bankbookz_DB.TICKR_DATA_MAP_Monthly[tkr][moYMT];
    if(!dataSet){return}
    delete bankbookz_DB.TICKR_DATA_MAP_Monthly[tkr][moYMT];
    e.target.parentElement.parentElement.parentElement.remove();   
    save_BANKBOOKZ_DB();      
}
function deleteTradeMaster(e){ debugger;}
function deleteTradeSubList(e){
    let moYMT = e.target.parentElement.previousElementSibling.innerText
    if(!moYMT){return}
    let dataSet = bankbookz_DB.TRADE_TXNZ_YMT[moYMT];
    if(!dataSet){return}
    delete bankbookz_DB.TRADE_TXNZ_YMT[moYMT];
    e.target.parentElement.parentElement.parentElement.remove();   
    save_BANKBOOKZ_DB();       
}
function deleteTickerClick(e){
    let userTKR = e.target.previousElementSibling.value;
    let item;
    for(var i=0;i<bankbookz_DB.TICKR_LIST.length;i++){
        item = bankbookz_DB.TICKR_LIST[i];
        if(userTKR===item.tkr){ //delete tkr
            bankbookz_DB.TICKR_LIST.splice(i,1)
            save_BANKBOOKZ_DB();
            init_TKRZ_TABZ();             
            return; 
        }
    }
}
//*********************END DELETEBTNS**********************/
// ******************************************SUBMENU & SUBLIST views
function getSubMenu_MarginView(tkr){
    return `<span>a</span><span>b</span>`;
}
function getSubMenu_TKRTXTArea(tkr,moKEY){
    let txtValue = 'No Data.',txnSet=[];
    let tkrTXTArea = document.createElement('textarea')
    tkrTXTArea.id = `tkrTXTAREA_${tkr}_${moKEY}`;
    tkrTXTArea.classList.add('scrollBarV')
    // tkrTXTArea.classList.add('txtSizer')
    tkrTXTArea.classList.add('tkrTXTArea')
    txnSet = bankbookz_DB.TICKR_DATA_MAP_Monthly[tkr][moKEY];
    if(txnSet.length){txtValue = JSON.stringify(txnSet)}
    tkrTXTArea.value = txtValue;
    return tkrTXTArea;
}
function getSubMenu_TRADETXTArea(tkr,moKEY){
    let txtValue = 'No Data.',txnSet=[],item;
    let tkrTXTArea = document.createElement('textarea')
    tkrTXTArea.id = `tkrTXTAREA_${tkr}_${moKEY}`;
    tkrTXTArea.classList.add('scrollBarV')
    tkrTXTArea.classList.add('tkrTXTArea')
    txnSet = bankbookz_DB.TRADE_TXNZ_YMT[moKEY];
    if(txnSet && txnSet.length){txtValue = JSON.stringify(txnSet)}
    tkrTXTArea.value = txtValue;
    return tkrTXTArea;
}
// ******************************************END VIEW METHODS**********

</script><!--*****************************END MAIN_APP******************-->
<script type="module">
// *****************************************CHECKBOX METHODS**********
import {BandsChart_Class as BandsChart_Class} from "./module/BANDLINES_3.js";
import {g as getMockData} from "./module/sample-data.js";

function init_Trendz_CHART(tkr){
    let checkz = get_Checked(tkr);
    // let tgt_Chart = document.getElementById(`trendzFRAME_${tkr}`)

    const TrendzChart = LightweightCharts.createChart(`trendzFRAME_${tkr}`, { 
        width:400,height:300,autoSize:false, 
        layout: {textColor:'steelblue',background: { type: 'solid', color: '#000000' }},
        grid: { vertLines: { color: "#080808" }, horzLines: { color: "#080808" } },
        // priceScale:{position: 'left',scaleMargins: {top: 0.2, bottom: 0.2 } },
        allowShiftVisibleRangeOnWhitespaceReplacement:true
    })
    const lineSeries = TrendzChart.addLineSeries()
    const bands_DataSet = getMockData();
    lineSeries.setData(bands_DataSet);
//     const BandsChart = new BandsChart_Class;
//     lineSeries.attachPrimitive(BandsChart);
// //**************************************** DRAW MONTH LINES ********************
//    import {MonthTrendLines_Class as MonthTrendLines_Class} from "./module/MONTHLINES_3.js";
//     let MonthStartDates = []
//     bands_DataSet.forEach(data => {
//         const tgtDate = new Date(data.time * 1000); // Convert timestamp to date object
//         if (tgtDate.getDate() === 1) { //Found 1st Day of Month.
//             const yearNUM = tgtDate.getFullYear();
//             const monthNUM = (tgtDate.getMonth() + 1).toString();//.padStart(2, '0'); // Adding 1 because months are zero-indexed
//             const dayNUM = tgtDate.getDate().toString();//.padStart(2, '0');
//             const current_ymd = `YMD_${yearNUM}_${monthNUM}_${dayNUM}`;
//             MonthStartDates.push(data)
//         }
//     });
//     let Num_Month_Crop=12;
//     if(MonthStartDates.length>Num_Month_Crop){ //CROP LAST Num of MONTHS.
//         MonthStartDates = MonthStartDates.splice(MonthStartDates.length-Num_Month_Crop,Num_Month_Crop)
//     }
//     let vLine, dItem;
//     for(var ii=0;ii<MonthStartDates.length;ii++){
//         dItem = MonthStartDates[ii];
//         vLine = new MonthTrendLines_Class(LineChart,lineSeries,
//             dItem.time,dItem.value,
//             {showLabel: !1,color: "steelblue",width: 1 });
//         lineSeries.attachPrimitive(vLine);
//     } 
// //-------------------------------------------------------------------
// //*********************************************************VOLUME SERIES*******
// const volumeSeries = LineChart.addHistogramSeries({
//         color: '#26a69a', priceFormat: { type: 'volume' }, priceScaleId: '', // set as an overlay by setting a blank priceScaleId
//         scaleMargins: { top: 0.7, bottom: 0 } //70%off top
//     });
//     volumeSeries.priceScale().applyOptions({
//         scaleMargins: { top: 0.7, bottom: 0 } //70% off top
//     });
// volumeSeries.setData([
//     { time: '2019-01-10', value: 14259910.00, color: '#26a69a' },{ time: '2019-01-11', value: 15801548.00, color: '#26a69a' }, { time: '2019-01-14', value: 11342293.00, color: '#26a69a' },    
//     { time: '2019-01-15', value: 10074386.00, color: '#26a69a' }]);


    if(checkz.linez_opt){
        
    }
    if(checkz.candlez_opt){

    }
    if(checkz.avgz_opt){

    }
    if(checkz.volz_opt){

    }
    if(checkz.a3dz_opt){

    }
    if(checkz.greenband_opt){

    }
    if(checkz.bollz_opt){

    }
    if(checkz.cci_opt){

    }
    if(checkz.mom_opt){

    }
    

    // EXAMPLE CANDLE
    // const chartOptions = {width:400,height:300,autoSize:false,
    //     layout:{textColor:'steelblue',fontSize:9,fontFamily:'sans-serif',//'Roboto',// fontBoldWeight: 800,
    //         background:{type:'solid',color:'#000000'} },
    //     grid: { vertLines: { color: "#080808" }, horzLines: { color: "#080808" } },
    //     crosshair:{mode:LightweightCharts.CrosshairMode.Normal,
    //         vertLine:{color:"darkslategrey"},horzLine:{color:"darkslategrey"} },
    //     // rightPriceScale:{visible:false},leftPriceScale:{visible:true},
    //     // priceScale:{position: 'right',scaleMargins: {top: 0.2, bottom: 0.2 } },
    // }
    // let tgtTKR = tgtELEM.id.split('_')[1]; 
    // let candleSeriesDATA = getCandleSeriesDATA(tgtTKR);
    // if(!candleSeriesDATA.length){ tgtELEM.innerHTML='<i style="font-size:0.555em;margin:0.888em;">No data.</i>'; return; }
    // tgtELEM.innerHTML=''; //blank out
    // const Dyna_Chart_CandleStick = LightweightCharts.createChart(tgtELEM, chartOptions);  
    // // CANDLESTICK-SERIES******************************************************        
    // const candlestickSeries = Dyna_Chart_CandleStick.addCandlestickSeries({
    //     priceScaleId: 'right', layout: {textColor:'steelblue',background: { type: 'solid', color: '#000000' } },
    //     wickUpColor: "#26a69a",upColor: "#26a69a",wickDownColor: "rgb(225, 50, 85)",downColor: "rgb(225, 50, 85)",
    // });
    // candleSeriesDATA = ensureOrderASC(candleSeriesDATA);   //IMPORT ASC - todo
    // candlestickSeries.setData(candleSeriesDATA);
    // let candleSeriesSUBSELECT = getCandleSubSELECT(tgtTKR); //SUB SELECTORS - LOGIC.
    // if(candleSeriesSUBSELECT==='struct'){ //STRUCTURE LINES.

    // }else{ //TRADE_MARKERS
    //     let tradeMarkerData = getMarker_TRADE_DATA(tgtTKR);
    //     tradeMarkerData = padTimeWithZeros(tradeMarkerData); //IMPORT PAD - todo
    //     tradeMarkerData = ensureOrderASC(tradeMarkerData);   //IMPORT ASC - todo
    //     candlestickSeries.setMarkers(tradeMarkerData);        
    // }
    // Dyna_Chart_CandleStick.timeScale().fitContent();    
    // resize_DYNA_CHART_Candle(Dyna_Chart_CandleStick);
    // DYNA_CHART_CANDLES.push(Dyna_Chart_CandleStick); //for screen resize

}//END TRENDZ INIT
function init_Trendz_CHECKBOXES(){
    const checkboxes = document.querySelectorAll('.Trendz_CHECKBOX');
    let elemID;
    checkboxes.forEach(checkbox => {
        elemID = checkbox.id.split('_')[2]
        checkbox.addEventListener('change', (event) => {
            const isChecked = event.target.checked;
            const tkr = event.target.id.split('_')[2];
            if(!tkr){return}
            console.log(`${tkr} Checkbox ${checkbox.id} is ${isChecked ? 'checked' : 'unchecked'}`);
            debugger;
            init_Trendz_CHART(tkr); //refresh
        });
        init_Trendz_CHART(elemID);//default chart
    });
}; init_Trendz_CHECKBOXES();
function get_Checked(tkr){
    if(!tkr){return}
    let linezElem = document.getElementById(`linez_opt_${tkr}`);
    let candlezElem = document.getElementById(`candlez_opt_${tkr}`);
    let avgzElem = document.getElementById(`avgz_opt_${tkr}`);
    let volzElem = document.getElementById(`volz_opt_${tkr}`);
    let a3dzElem = document.getElementById(`3dz_opt_${tkr}`);
    let greenbandElem = document.getElementById(`greenband_opt_${tkr}`);
    let bollzElem = document.getElementById(`bollz_opt_${tkr}`);
    let cciElem = document.getElementById(`cci_opt_${tkr}`);
    let momElem = document.getElementById(`mom_opt_${tkr}`);
    let checked_selection = {
        linez_opt: linezElem.checked,
        candlez_opt: candlezElem.checked,
        avgz_opt: avgzElem.checked,
        volz_opt: volzElem.checked,
        a3dz_opt: a3dzElem.checked,
        greenband: greenbandElem.checked,
        bollz_opt: bollzElem.checked,
        cci_opt: cciElem.checked,
        mom_opt: momElem.checked
    }
    return checked_selection;
}
// ********************************END CHECKBOXES***************************
</script>
<script>/****************************************CRYPTO OHLCV API***********/
let stock_api_key = null;//API_KEY - set in local storage.
let init_api_key = ()=>{
   if(localStorage.stock_api_key){
        stock_api_key = localStorage.stock_api_key;
        let status = document.getElementById('connectStatus')
        status.innerHTML='CONNECTED'        
   }
}; 
setTimeout(init_api_key,100);
let setAPIKEY = ()=>{
    let keyINPUT = document.getElementById('keyINPUT');  
    if(keyINPUT.value){
        stock_api_key = keyINPUT.value;
        localStorage.stock_api_key = stock_api_key;
        let status = document.getElementById('connectStatus')
        status.innerHTML='CONNECTED'
    }
}; 
//***********************************************STOCK LOOP*************
//HI-LEVEL_UTILITIES*************************
const getLastPriceClick = async ()=>{ //loop all for last close.
    let item,queries=[],tkrREC,tkr;
    for(var i=0; i<bankbookz_DB.TICKR_LIST.length;i++){
        tkrTGT = bankbookz_DB.TICKR_LIST[i];        
        tkr = tkrTGT.tkr;        
        if(getAPI_Limiter(tkr)){continue;} //CHECK LastRefreshTime
        // if(i>=1){break;}//DEV_limiter stay below 20
        // tkr = 'AMZN';//'NVDA';//DEV_specifier 
        queries.push(tkr);
   }
   if(stock_api_key && queries.length){
        console.log('...get stocks & crypto...')
        await call_Various_Stock_API(queries);
        show_USERMSG({txt:'Data Updated',icon:'🛠️',time:3000});
    } else {
        show_USERMSG({txt:'Daily Limit',icon:'⚠️'})
   }
   console.log('SAVED NEW DATA')
   await save_BANKBOOKZ_DB();
}
const call_Various_Stock_API = async (queries)=>{
   try{
      for(let i=0; i<queries.length;i++){
         console.log('Query:',queries[i])
         //CRYPTO QUERIES-----------------------------------
         if(queries[i]==='BTC' 
            || queries[i]==='ETH'  
            || queries[i]==='UNI'  
            || queries[i]==='AVAX' ){
            console.log('GET Crypto:',queries[i])
            await getCrypto_Daily(queries[i])
            continue;
            //END CRYPTO QUERIES-----------------------------------
         }else if(queries[i]==='NVDA'){ //ADJUSTED WEEKLY STOCKS.
            await getStock_Weekly_Adjusted(queries[i]);
            continue;
         } else{
            await getCrypto_Daily(queries[i])
            continue;
         }
        // await fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${queries[i]}&apikey=${stock_api_key}`)
        // // await fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_WEEKLY_ADJUSTED&symbol=${queries[i]}&apikey=${stock_api_key}`)
        // .then((data)=>{
        //     if(data.ok){
        //        return data.json();
        //     } else{ debugger; }
        //  }).then((tickData)=>{
        //     if(tickData.Information && tickData.Information.indexOf('Thank you')===0){
        //         show_USERMSG({txt:'Daily Limit',icon:'⚠️'})
        //        return;
        //     }
        //     if(!tickData || !tickData["Meta Data"] || !tickData["Meta Data"]["2. Symbol"] ){
        //        debugger; //todo
        //     }
        //     let resTKR = tickData["Meta Data"]["2. Symbol"];
        //     // if(resTKR==='NVDA'){debugger;}
        //     if(!resTKR){return;}
        //     console.log('GOT_STOCK:',resTKR)
        //     const tickDaily_RAW = tickData["Time Series (Daily)"]
        //     // const tickDaily_RAW = tickData["Weekly Adjusted Time Series"];
        //     if(!tickDaily_RAW){return;}
        //     let tickDaily_KEYS = Object.keys(tickDaily_RAW)     
        //     // let reduceData = 50; //too much data reduce from 2000 to 200.
        //     // tickDaily_KEYS = tickDaily_KEYS.splice(0,reduceData)        
        //     tickDaily_KEYS.reverse(); //CONFIRM: earliest ASC for LWC.
        //     const tickDaily_TV = [];
        //     let obj;
        //     let lastRefreshTime = tickData["Meta Data"]["3. Last Refreshed"];
        //     for (const aKey of tickDaily_KEYS) {  //FORMAT TO TRADING VIEW.
        //         obj = tickDaily_RAW[aKey];
        //         tickDaily_TV.push({
        //             tkr:resTKR,
        //             time: aKey,     
        //             open: parseFloat(obj["1. open"]),
        //             high: parseFloat(obj["2. high"]),    
        //             low: parseFloat(obj["3. low"]),     
        //             close: parseFloat(obj["4. close"]),    
        //             volume: Math.round( parseFloat(obj["5. volume"]) )     
        //         });
        //     }
        //     bankbookz_DB.METASTATE.lastRefreshMap[resTKR] = lastRefreshTime;
        //     save_NEW_Stock_DAILY(tickDaily_TV)
        //     bankbookz_DB.METASTATE.lastRefreshMap[resTKR]
        // }).catch((error)=>{
        //     debugger;
        //     console.log(error)
        // })
      }
   } catch(error) {
        debugger;
   }           
}
//********************************************END STOCK LOOP*************
const getCrypto_Daily = async (tkrTGT)=>{
    // if(tkrTGT==='BTC'||tkrTGT==='ETH'){ debugger; };//console.log(`GET ${tkrTGT}`)}else{return}
    // if(getAPI_Limiter(tkrTGT)){return} //CHECK LastRefreshTime
    if(!stock_api_key){return}
    let url = `https://www.alphavantage.co/query?function=DIGITAL_CURRENCY_DAILY&symbol=${tkrTGT}&market=USD&interval=5min&apikey=${stock_api_key}`;
    await fetch(url).then((data)=>{
        if(data.ok){ return data.json();} else{ console.log('err1');}
        }).then((tickResp)=>{
            let tkr = tickResp["Meta Data"]["2. Digital Currency Code"].toUpperCase();
            console.log('RESPONSE:',tkr);
            const tickDaily_RAW = tickResp["Time Series (Digital Currency Daily)"]
            const tickDaily_KEYS = Object.keys(tickDaily_RAW)   
            tickDaily_KEYS.reverse(); //CONFIRM: earliest ASC for LWC.          
            const tickDaily_TV = [];
            let obj;
            let lastRefreshTime = tickResp["Meta Data"]["6. Last Refreshed"];
            for (const aKey of tickDaily_KEYS) {  //FORMAT TO TRADING VIEW.
                obj = tickDaily_RAW[aKey];
                tickDaily_TV.push({
                    tkr:tkr,
                    time: aKey,     
                    open: parseFloat(obj["1. open"]),
                    high: parseFloat(obj["2. high"]),    
                    low: parseFloat(obj["3. low"]),     
                    close: parseFloat(obj["4. close"]),    
                    volume: Math.round( parseFloat(obj["5. volume"]) )     
                });
            }
            bankbookz_DB.METASTATE.lastRefreshMap[tkr] = lastRefreshTime;
            save_NEW_CRYPTO_DAILY(tickDaily_TV); //skip duplicates, add local storage
            let status = document.getElementById('connectStatus')
            status.innerHTML='UPDATED'
        }).catch((error)=>{
            console.log('API: Daily Limit.')
            console.log(error)
            let status = document.getElementById('connectStatus')
            status.innerHTML='DISCONNECTED'            
    })
}
const getStock_Daily = async (tkr)=>{
    await fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${tkr}&apikey=${stock_api_key}`)
    // await fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_WEEKLY_ADJUSTED&symbol=${queries[i]}&apikey=${stock_api_key}`)
    .then((data)=>{
        if(data.ok){
            return data.json();
        } else{ debugger; }
        }).then((tickData)=>{
        if(tickData.Information && tickData.Information.indexOf('Thank you')===0){
            show_USERMSG({txt:'Daily Limit',icon:'⚠️'})
            return;
        }
        if(!tickData || !tickData["Meta Data"] || !tickData["Meta Data"]["2. Symbol"] ){
            debugger; //todo
        }
        let resTKR = tickData["Meta Data"]["2. Symbol"];
        // if(resTKR==='NVDA'){debugger;}
        if(!resTKR){return;}
        console.log('GOT_STOCK:',resTKR)
        const tickDaily_RAW = tickData["Time Series (Daily)"]
        // const tickDaily_RAW = tickData["Weekly Adjusted Time Series"];
        if(!tickDaily_RAW){return;}
        let tickDaily_KEYS = Object.keys(tickDaily_RAW)     
        // let reduceData = 50; //too much data reduce from 2000 to 200.
        // tickDaily_KEYS = tickDaily_KEYS.splice(0,reduceData)        
        tickDaily_KEYS.reverse(); //CONFIRM: earliest ASC for LWC.
        const tickDaily_TV = [];
        let obj;
        let lastRefreshTime = tickData["Meta Data"]["3. Last Refreshed"];
        for (const aKey of tickDaily_KEYS) {  //FORMAT TO TRADING VIEW.
            obj = tickDaily_RAW[aKey];
            tickDaily_TV.push({
                tkr:resTKR,
                time: aKey,     
                open: parseFloat(obj["1. open"]),
                high: parseFloat(obj["2. high"]),    
                low: parseFloat(obj["3. low"]),     
                close: parseFloat(obj["4. close"]),    
                volume: Math.round( parseFloat(obj["5. volume"]) )     
            });
        }
        bankbookz_DB.METASTATE.lastRefreshMap[resTKR] = lastRefreshTime;
        save_NEW_Stock_DAILY(tickDaily_TV)
        bankbookz_DB.METASTATE.lastRefreshMap[resTKR]
    }).catch((error)=>{
        debugger;
        console.log(error)
    })
}
const  getStock_Weekly_Adjusted = async(tkr)=>{
    await fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${tkr}&apikey=${stock_api_key}`)
    // await fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_WEEKLY_ADJUSTED&symbol=${queries[i]}&apikey=${stock_api_key}`)
    .then((data)=>{
        if(data.ok){
            return data.json();
        } else{ debugger; }
        }).then((tickData)=>{
        if(tickData.Information && tickData.Information.indexOf('Thank you')===0){
            show_USERMSG({txt:'Daily Limit',icon:'⚠️'})
            return;
        }
        if(!tickData || !tickData["Meta Data"] || !tickData["Meta Data"]["2. Symbol"] ){
            debugger; //todo
        }
        let resTKR = tickData["Meta Data"]["2. Symbol"];
        // if(resTKR==='NVDA'){debugger;}
        if(!resTKR){return;}
        console.log('GOT_STOCK:',resTKR)
        // const tickDaily_RAW = tickData["Time Series (Daily)"]
        const tickDaily_RAW = tickData["Weekly Adjusted Time Series"];
        if(!tickDaily_RAW){return;}
        let tickDaily_KEYS = Object.keys(tickDaily_RAW)     
        let reduceData = 50; //too much data reduce from 2000 to 200.
        tickDaily_KEYS = tickDaily_KEYS.splice(0,reduceData)        
        tickDaily_KEYS.reverse(); //CONFIRM: earliest ASC for LWC.
        const tickDaily_TV = [];
        let obj;
        let lastRefreshTime = tickData["Meta Data"]["3. Last Refreshed"];
        for (const aKey of tickDaily_KEYS) {  //FORMAT TO TRADING VIEW.
            obj = tickDaily_RAW[aKey];
            tickDaily_TV.push({
                tkr:resTKR,
                time: aKey,     
                open: parseFloat(obj["1. open"]),
                high: parseFloat(obj["2. high"]),    
                low: parseFloat(obj["3. low"]),     
                close: parseFloat(obj["4. close"]),    
                volume: Math.round( parseFloat(obj["5. volume"]) )     
            });
        }
        bankbookz_DB.METASTATE.lastRefreshMap[resTKR] = lastRefreshTime;
        save_NEW_Stock_DAILY(tickDaily_TV)
        bankbookz_DB.METASTATE.lastRefreshMap[resTKR]
    }).catch((error)=>{
        debugger;
        console.log(error)
    })
}
//******************************************************END API****************
function getAPI_Limiter(tkr){
    if(!bankbookz_DB.METASTATE.lastRefreshMap[tkr]){bankbookz_DB.METASTATE.lastRefreshMap[tkr]=''}
    let lastRefreshDay = bankbookz_DB.METASTATE.lastRefreshMap[tkr].split(' ')[0]
    let dailyLimit = (lastRefreshDay===`${yearNUM}-${monthNUM}-${dayNUM}`)
    if(dailyLimit){ console.log('API: Daily Limit '+lastRefreshDay) }
    return dailyLimit;
}
function save_NEW_Stock_DAILY(tickDaily_TV){ 
   let tkrREC,tkrYMT,txnItem,ymd, ym, YMT,txnFound=false;
    let dupeCNT=0,newCNT=0;//DEDUPE:iterate localstorage, if same rec, continue, else, add rec.
    // tickDaily_TV.reverse();//chronologically, smallest first for LWC.
    for (const aTicker of tickDaily_TV) {
        ymd = aTicker.time.replace(/-/g, "_");
        // ym = ymd.split("_")[0] +"_"+ parseInt(ymd.split("_")[1]);//remove padding.
        ym = ymd.split("_")[0] +"_"+ymd.split("_")[1].padStart(2, '0');//add padding.
        YMT = ym + '_' + aTicker.tkr //for sub rec 
        // ymdt = ymd +'_'+ aTicker.tkr;
        tkrREC = bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr];
        if(!tkrREC){ //ORGANIZED BY TKR, then YMT - NEW
            bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr] = {}
            tkrREC = bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr];
            console.log('CREATED TKR Record:',aTicker.tkr)
        }
        tkrYMT = tkrREC[YMT]; //GET SUB YMT
        if(!tkrYMT){ //SUB ORGANIZE BY MONTHLY (YMT) - NEW
            bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr][YMT] = [];
            tkrYMT = bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr][YMT];
        }
        //CHECK FOR DUPLICATE RECORDS.
        txnFound=false;
        for(var ii=0;ii<tkrYMT.length;ii++){
            txnItem = tkrYMT[ii];
            if(!txnItem.time){continue}
            if(aTicker.time===txnItem.time){ //DUPLICATE RECORD
                dupeCNT++;
                txnFound=true;
                break;
            } 
        }
        if(!txnFound){ //NEW RECORD, unshift, else chronological error.
            newCNT++;
            // bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr][YMT].unshift(aTicker)
            bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr][YMT].push(aTicker); //ORDERED for LWC.
            // bankbookz_DB.TICKR_DATA_MAP_Monthly[aTKR][YMT] = ensureOrderASC(bankbookz_DB.TICKR_DATA_MAP_Monthly[aTKR][YMT]);   //todo move this to IMPORT
            //TODO: reverse data order across db and app? no. ASC for LWC DESC for Edit.
        }
    }
    console.log(`Response; Dupes:${dupeCNT}, NEW recs:${newCNT}`)     
}
function save_NEW_CRYPTO_DAILY(tickDaily_TV){ //skip duplicates, add local storage
    let tkrREC,tkrYMT,txnItem,ymd, ym, YMT,txnFound=false;
    let dupeCNT=0,newCNT=0;//DEDUPE:iterate localstorage, if same rec, continue, else, add rec.
    // tickDaily_TV.reverse();//Sort ASC, else LWC error.
    for (const aTicker of tickDaily_TV) {
        ymd = aTicker.time.replace(/-/g, "_");
        // ym = ymd.split("_")[0] +"_"+ parseInt(ymd.split("_")[1]);//remove padding.
        ym = ymd.split("_")[0] +"_"+ymd.split("_")[1].padStart(2, '0');//add padding.
        YMT = ym + '_' + aTicker.tkr //for sub rec 
        // ymdt = ymd +'_'+ aTicker.tkr;
        tkrREC = bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr];
        if(!tkrREC){ //ORGANIZED BY TKR, then YMT - NEW
            bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr] = {}
            tkrREC = bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr];
        }
        tkrYMT = tkrREC[YMT]; //GET SUB YMT
        if(!tkrYMT){ //SUB ORGANIZE BY MONTHLY (YMT) - NEW
            bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr][YMT] = [];
            tkrYMT = bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr][YMT];
            console.log('CREATED TKR Record:',aTicker.tkr)
        }
        //CHECK FOR DUPLICATE RECORDS.
        txnFound=false;
        for(var ii=0;ii<tkrYMT.length;ii++){
            txnItem = tkrYMT[ii];
            if(!txnItem.time){continue}
            if(aTicker.time===txnItem.time){ //DUPLICATE RECORD
                dupeCNT++;
                txnFound=true;
                break;
            } 
        }
        if(!txnFound){ //NEW RECORD, unshift, else chronological error.
            newCNT++
            // bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr][YMT].unshift(aTicker)
            bankbookz_DB.TICKR_DATA_MAP_Monthly[aTicker.tkr][YMT].push(aTicker); //ORDERED for LWC.
        }
    }
    console.log(`Response; Dupes:${dupeCNT}, NEW recs:${newCNT}`) 
}
</script><!--*****************************END STOCK DATA API******************-->
<!--***************************** ADVANCED CHARTS ******************-->

<!--***************************** END ADVANCED CHARTS ******************-->
<footer id="FOOTER_BOX">
    <!-- <section id="keyBOX" style="display:flex;border: solid 1px steelblue;
    border-radius: 13px;padding: 2px 6px;color: #022e64;align-items: center;
    margin:1em 1% 1em 1%;">
        AA_API:<input id="keyINPUT"  type="new-password" placeholder="api_key" 
        style="margin-left: 1em; background:#233453;
        border-radius: 10px 0px 0px 10px;"></input>
        <button style="margin-right: 1em; background:#03cbcb;cursor:pointer;
        border-radius: 0px 10px 10px 0px; font-size:0.777em;padding: 4px;" onclick="setAPIKEY();">SET</button>
    </section>  
    <section id="connectStatus" style="font-size: 0.666em;margin-right:2%;color:aqua;">disconnected</section>
    <button id="latestBtn1" class="blackBTN" style="margin:1em 1% 1em 1%;"
        onclick="getLastPriceClick()">GET Latest Prices🔄</button> -->
        <!-- onclick="getCrypto_Loop()">get Prices🔄</button> -->
</footer>
<!--***************************** END STOCK API INPUT******************-->
<!--***************************** XMPL CHART MODULES******************-->
<script type="module">
    import {g as getRandomDataSet} from "./module/sample-data.js";
    import {TrendLine_Class as TrendLine_Class} from "./module/trendlines.js";
    const TrendLineChart_XMPL = LightweightCharts.createChart("trend_line_chart_xmpl", 
        {width:400,height:300, autoSize:true, 
        grid: { vertLines: { color: "#080808" }, horzLines: { color: "#080808" } },
        layout: {textColor:'steelblue',background: { type: 'solid', color: '#000000' } 
        }, allowShiftVisibleRangeOnWhitespaceReplacement:true
    })
    const lwc_lineSeries = TrendLineChart_XMPL.addLineSeries()
    const  dataSet = getRandomDataSet();
    lwc_lineSeries.setData(dataSet);
    const len = dataSet.length;
    const EndPoint={time: dataSet[len - 50].time,price: dataSet[len - 50].value * .9}
    const StartPoint={time: dataSet[len - 5].time,price: dataSet[len - 5].value * 1.1}
    const trendLine1 = new TrendLine_Class(TrendLineChart_XMPL,lwc_lineSeries,EndPoint,StartPoint);
    lwc_lineSeries.attachPrimitive(trendLine1);
    let topEND={},topSTART={};
    topEND.time = EndPoint.time;
    topEND.price = EndPoint.price+10;
    topSTART.time = StartPoint.time;
    topSTART.price = StartPoint.price+200;
    const lineOptions_TOP = {width:1,showLabels:true,lineColor:"rgb(0, 255, 88)",
        labelBackgroundColor: "rgba(0, 0, 55, 0.85)", labelTextColor: "steelblue"
    };            
    const trendLineTOP = new TrendLine_Class(TrendLineChart_XMPL,lwc_lineSeries,topEND,topSTART,lineOptions_TOP);
    lwc_lineSeries.attachPrimitive(trendLineTOP);
    let midEND={},midSTART={};
    midEND.time = EndPoint.time;
    midEND.price = EndPoint.price-10;
    midSTART.time = StartPoint.time;
    midSTART.price = EndPoint.price-10;
    const lineOptions_MID = {width:1,showLabels:true,lineColor:"rgb(0, 144, 188)",
        labelBackgroundColor: "rgba(0, 0, 55, 0.85)", labelTextColor: "steelblue",
        // LineStyle:'Dotted'
    };
    const trendLine_MID = new TrendLine_Class(TrendLineChart_XMPL,lwc_lineSeries,midEND,midSTART,lineOptions_MID);
    lwc_lineSeries.attachPrimitive(trendLine_MID);
    let btmEND={},btmSTART={};
    btmEND.time = EndPoint.time;
    btmEND.price = EndPoint.price-10;
    btmSTART.time = StartPoint.time;
    btmSTART.price = StartPoint.price-200;
    const lineOptions_BTM = {width:1,showLabels:true,lineColor:"rgb(255, 0, 88)",
        labelBackgroundColor: "rgba(0, 0, 55, 0.85)", labelTextColor: "steelblue"
    };
    const trendLine_BTM = new TrendLine_Class(TrendLineChart_XMPL,lwc_lineSeries,btmEND,btmSTART,lineOptions_BTM);
    lwc_lineSeries.attachPrimitive(trendLine_BTM);
</script>
<script type="module">
    //-------------------------------------------GREEN BAND LINE 1---------------
    import {BandsChart_Class as BandsChart_Class} from "./module/BANDLINES_3.js";
    import {g as getMockData} from "./module/sample-data.js";
    const LineChart = LightweightCharts.createChart("xmpl_bands_chart", { 
        width:400,height:300,autoSize:true, 
        layout: {textColor:'steelblue',background: { type: 'solid', color: '#000000' }},
        grid: { vertLines: { color: "#080808" }, horzLines: { color: "#080808" } },
        // priceScale:{position: 'left',scaleMargins: {top: 0.2, bottom: 0.2 } },
        allowShiftVisibleRangeOnWhitespaceReplacement:true
    })
    const lineSeries = LineChart.addLineSeries()
    const bands_DataSet = getMockData();
    lineSeries.setData(bands_DataSet);
    const BandsChart = new BandsChart_Class;
    lineSeries.attachPrimitive(BandsChart);
//**************************************** DRAW MONTH LINES ********************
   import {MonthTrendLines_Class as MonthTrendLines_Class} from "./module/MONTHLINES_3.js";
    let MonthStartDates = []
    bands_DataSet.forEach(data => {
        const tgtDate = new Date(data.time * 1000); // Convert timestamp to date object
        if (tgtDate.getDate() === 1) { //Found 1st Day of Month.
            const yearNUM = tgtDate.getFullYear();
            const monthNUM = (tgtDate.getMonth() + 1).toString();//.padStart(2, '0'); // Adding 1 because months are zero-indexed
            const dayNUM = tgtDate.getDate().toString();//.padStart(2, '0');
            const current_ymd = `YMD_${yearNUM}_${monthNUM}_${dayNUM}`;
            MonthStartDates.push(data)
        }
    });
    let Num_Month_Crop=12;
    if(MonthStartDates.length>Num_Month_Crop){ //CROP LAST Num of MONTHS.
        MonthStartDates = MonthStartDates.splice(MonthStartDates.length-Num_Month_Crop,Num_Month_Crop)
    }
    let vLine, dItem;
    for(var ii=0;ii<MonthStartDates.length;ii++){
        dItem = MonthStartDates[ii];
        vLine = new MonthTrendLines_Class(LineChart,lineSeries,
            dItem.time,dItem.value,
            {showLabel: !1,color: "steelblue",width: 1 });
        lineSeries.attachPrimitive(vLine);
    } 
//-------------------------------------------------------------------
//*********************************************************VOLUME SERIES*******
const volumeSeries = LineChart.addHistogramSeries({
        color: '#26a69a', priceFormat: { type: 'volume' }, priceScaleId: '', // set as an overlay by setting a blank priceScaleId
        scaleMargins: { top: 0.7, bottom: 0 } //70%off top
    });
    volumeSeries.priceScale().applyOptions({
        scaleMargins: { top: 0.7, bottom: 0 } //70% off top
    });
volumeSeries.setData([
    { time: '2019-01-10', value: 14259910.00, color: '#26a69a' },{ time: '2019-01-11', value: 15801548.00, color: '#26a69a' }, { time: '2019-01-14', value: 11342293.00, color: '#26a69a' },    { time: '2019-01-15', value: 10074386.00, color: '#26a69a' },
    { time: '2019-01-16', value: 13411691.00, color: '#ef5350' },{ time: '2019-01-17', value: 15223854.00, color: '#ef5350' }, { time: '2019-01-18', value: 16802516.00, color: '#26a69a' },    { time: '2019-01-22', value: 18284771.00, color: '#ef5350' },
    { time: '2019-01-23', value: 15109007.00, color: '#26a69a' },{ time: '2019-01-24', value: 12494109.00, color: '#ef5350' }, { time: '2019-01-25', value: 17806822.00, color: '#ef5350' },    { time: '2019-01-28', value: 25955718.00, color: '#ef5350' },
    { time: '2019-01-29', value: 33789235.00, color: '#ef5350' },{ time: '2019-01-30', value: 27260036.00, color: '#26a69a' }, { time: '2019-01-31', value: 28585447.00, color: '#26a69a' },    { time: '2019-02-01', value: 13778392.00, color: '#ef5350' },
    { time: '2019-02-04', value: 15818901.00, color: '#ef5350' },{ time: '2019-02-05', value: 14124794.00, color: '#26a69a' }, { time: '2019-02-06', value: 11391442.00, color: '#ef5350' },    { time: '2019-02-07', value: 12436168.00, color: '#ef5350' },
    { time: '2019-02-08', value: 12011657.00, color: '#26a69a' },{ time: '2019-02-11', value: 9802798.00, color: '#26a69a' }, { time: '2019-02-12', value: 11227550.00, color: '#26a69a' },    { time: '2019-02-13', value: 11884803.00, color: '#26a69a' },
    { time: '2019-02-14', value: 11190094.00, color: '#ef5350' },{ time: '2019-02-15', value: 15719416.00, color: '#26a69a' }, { time: '2019-02-19', value: 12272877.00, color: '#26a69a' },    { time: '2019-02-20', value: 11379006.00, color: '#26a69a' },
    { time: '2019-02-21', value: 14680547.00, color: '#26a69a' },{ time: '2019-02-22', value: 12534431.00, color: '#26a69a' }, { time: '2019-02-25', value: 15051182.00, color: '#ef5350' },    { time: '2019-02-26', value: 12005571.00, color: '#ef5350' },
    { time: '2019-02-27', value: 8962776.00, color: '#26a69a' },{ time: '2019-02-28', value: 15742971.00, color: '#26a69a' }, { time: '2019-03-01', value: 10942737.00, color: '#26a69a' },    { time: '2019-03-04', value: 13674737.00, color: '#ef5350' },
    { time: '2019-03-05', value: 15749545.00, color: '#ef5350' },{ time: '2019-03-06', value: 13935530.00, color: '#ef5350' }, { time: '2019-03-07', value: 12644171.00, color: '#26a69a' },    { time: '2019-03-08', value: 10646710.00, color: '#26a69a' },
    { time: '2019-03-11', value: 13627431.00, color: '#26a69a' },{ time: '2019-03-12', value: 12812980.00, color: '#ef5350' }, { time: '2019-03-13', value: 14168350.00, color: '#26a69a' },    { time: '2019-03-14', value: 12148349.00, color: '#26a69a' },
    { time: '2019-03-15', value: 23715337.00, color: '#26a69a' },{ time: '2019-03-18', value: 12168133.00, color: '#ef5350' }, { time: '2019-03-19', value: 13462686.00, color: '#ef5350' },    { time: '2019-03-20', value: 11903104.00, color: '#26a69a' },
    { time: '2019-03-21', value: 10920129.00, color: '#26a69a' },{ time: '2019-03-22', value: 25125385.00, color: '#26a69a' }, { time: '2019-03-25', value: 15463411.00, color: '#26a69a' },    { time: '2019-03-26', value: 12316901.00, color: '#26a69a' },
    { time: '2019-03-27', value: 13290298.00, color: '#26a69a' },{ time: '2019-03-28', value: 20547060.00, color: '#ef5350' }, { time: '2019-03-29', value: 17283871.00, color: '#26a69a' },    { time: '2019-04-01', value: 16331140.00, color: '#ef5350' },
    { time: '2019-04-02', value: 11408146.00, color: '#ef5350' },{ time: '2019-04-03', value: 15491724.00, color: '#26a69a' }, { time: '2019-04-04', value: 8776028.00, color: '#26a69a' },    { time: '2019-04-05', value: 11497780.00, color: '#26a69a' },
    { time: '2019-04-08', value: 11680538.00, color: '#26a69a' },{ time: '2019-04-09', value: 10414416.00, color: '#ef5350' }, { time: '2019-04-10', value: 8782061.00, color: '#26a69a' },    { time: '2019-04-11', value: 9219930.00, color: '#ef5350' },
    { time: '2019-04-12', value: 10847504.00, color: '#26a69a' },{ time: '2019-04-15', value: 7741472.00, color: '#ef5350' }, { time: '2019-04-16', value: 10239261.00, color: '#26a69a' },    { time: '2019-04-17', value: 15498037.00, color: '#ef5350' },
    { time: '2019-04-18', value: 13189013.00, color: '#26a69a' },{ time: '2019-04-22', value: 11950365.00, color: '#26a69a' }, { time: '2019-04-23', value: 23488682.00, color: '#ef5350' },    { time: '2019-04-24', value: 13227084.00, color: '#ef5350' },
    { time: '2019-04-25', value: 17425466.00, color: '#ef5350' },{ time: '2019-04-26', value: 16329727.00, color: '#26a69a' }, { time: '2019-04-29', value: 13984965.00, color: '#26a69a' },    { time: '2019-04-30', value: 15469002.00, color: '#26a69a' },
    { time: '2019-05-01', value: 11627436.00, color: '#ef5350' },{ time: '2019-05-02', value: 14435436.00, color: '#26a69a' }, { time: '2019-05-03', value: 9388228.00, color: '#26a69a' },    { time: '2019-05-06', value: 10066145.00, color: '#ef5350' },
    { time: '2019-05-07', value: 12963827.00, color: '#ef5350' },{ time: '2019-05-08', value: 12086743.00, color: '#ef5350' }, { time: '2019-05-09', value: 14835326.00, color: '#26a69a' },    { time: '2019-05-10', value: 10707335.00, color: '#26a69a' },
    { time: '2019-05-13', value: 13759350.00, color: '#ef5350' },{ time: '2019-05-14', value: 12776175.00, color: '#ef5350' }, { time: '2019-05-15', value: 10806379.00, color: '#26a69a' },    { time: '2019-05-16', value: 11695064.00, color: '#26a69a' },
    { time: '2019-05-17', value: 14436662.00, color: '#26a69a' },{ time: '2019-05-20', value: 20910590.00, color: '#26a69a' }, { time: '2019-05-21', value: 14016315.00, color: '#26a69a' },    { time: '2019-05-22', value: 11487448.00, color: '#ef5350' },
    { time: '2019-05-23', value: 11707083.00, color: '#ef5350' },{ time: '2019-05-24', value: 8755506.00, color: '#26a69a' }, { time: '2019-05-28', value: 3097125.00, color: '#26a69a' }, ]);
 //---------------------------------END VOLUME SERIES---------------------   
</script>

<script type="module">//*******************************MOVING AVERAGES
import {calcMA,getFakeData} from "./module/MO_AVGS_3.js";
const chartOptions={ width:400, height:300,autoSize:true,
    grid: { vertLines: { color: "#080808" }, horzLines: { color: "#080808" } },
    layout:{textColor: 'white',background:{ type:'solid',color:'black' } } };
const chart = LightweightCharts.createChart(document.getElementById('xmpl_avgs_chart'), chartOptions);
const barData = getFakeData(500);
const maData20 = calcMA(barData, 20);
const maData120 = calcMA(barData, 100);
const maData200 = calcMA(barData, 200);
const maSeries20 = chart.addLineSeries({ color: 'yellow', lineWidth:2});
const maSeries120 = chart.addLineSeries({ color: 'purple', lineWidth:2});
const maSeries200 = chart.addLineSeries({ color: 'limegreen', lineWidth:2});
maSeries20.setData(maData20);
maSeries120.setData(maData120);
maSeries200.setData(maData200);
const candlestickSeries = chart.addCandlestickSeries({ upColor: '#26a69a',downColor: '#ef5350',
    borderVisible: false,wickUpColor: '#26a69a', wickDownColor: '#ef5350'});
candlestickSeries.setData(barData);
// 
    // import {SetPriceLine_Class as SetPriceLine_Class} from "./module/SETPRICELINE_5.js";  
    // import {g as getMockData} from "./module/sample-data.js";
    // const priceChart = LightweightCharts.createChart("xmpl_struct_chart", { width:400, height:300,autoSize:false, 
    //     layout: {textColor:'steelblue',background: { type: 'solid', color: '#000000' }},
    //     grid: { vertLines: { color: "#080808" }, horzLines: { color: "#080808" } },
    //     allowShiftVisibleRangeOnWhitespaceReplacement:!0
    // })
    // const priceSeries = priceChart.addLineSeries()
    // const data = getMockData();
    // priceSeries.setData(data);
</script> 
<script type="module">//*******************************EDIT - LINE - STRUCTURE
    import {SetPriceLine_Class as SetPriceLine_Class} from "./module/SETPRICELINE_5.js";  
    import {g as getMockData} from "./module/sample-data.js";
    const priceChart = LightweightCharts.createChart("xmpl_struct_chart", { 
        width:400, height:300,autoSize:true, 
        layout: {textColor:'steelblue',background: { type: 'solid', color: '#000000' }},
        grid: { vertLines: { color: "#080808" }, horzLines: { color: "#080808" } },
        allowShiftVisibleRangeOnWhitespaceReplacement:!0
    })
    const priceSeries = priceChart.addLineSeries()
    const data = getMockData();
    priceSeries.setData(data);
    let structs = new SetPriceLine_Class(priceChart,priceSeries,{ color: "steelblue"});
    // -- EXAMPLE--------------------------------------------------
    let line1 = priceSeries.createPriceLine({ price: 333, color: 'lime'})
    let line2 = priceSeries.createPriceLine({ price: 444, color: 'purple' })
    let line3 = priceSeries.createPriceLine({ price: 555, color: 'blue' })
    line1.applyOptions({ lineWidth: 3, lineStyle: LightweightCharts.LineStyle.Dashed });
    line2.applyOptions({ lineWidth: 2, lineStyle: LightweightCharts.LineStyle.Dashed });
    line3.applyOptions({ lineWidth: 1, lineStyle: LightweightCharts.LineStyle.Dotted });
    structs.setPricelines([{price: 333, line:line1}])
    structs.setPricelines([{price: 444, line:line2}])
    structs.setPricelines([{price: 555, line:line3}])
    //-----------------------------------------------LINE EDITOR---------
    window.smlLine = (event) => {
        let linePrice = Math.round(event.target.parentElement.parentElement.getAttribute('datapt') );
        console.log('Editing:',linePrice)
        structs.editPriceLine({ price: linePrice,size:'sml' });
    }    
    window.medLine = (event) => {
        let linePrice = Math.round(event.target.parentElement.parentElement.getAttribute('datapt') );
        console.log('Editing:',linePrice)
        structs.editPriceLine({ price: linePrice,size:'med' });
    }
    window.lrgLine = (event) => {
        let linePrice = Math.round(event.target.parentElement.parentElement.getAttribute('datapt') );
        console.log('Editing:',linePrice)
        structs.editPriceLine({ price: linePrice,size:'lrg' });
    }
    window.setLineColor = (event) => {
        let lineColor = event.target.value;
        let linePrice = Math.round(event.target.parentElement.getAttribute('datapt') );
        console.log('Editing:',linePrice)
        structs.editPriceLine({ price: linePrice,color:lineColor});
    }
</script>
<!--***************************** END XMPL CHART MODULES******************-->
<legal style="color:darkslategray;font-size: 0.444em;margin: 3.333em 10% 0 10%;
background-color: rgb(9, 0, 18);border-radius: 13px;padding: 1.444em;">
    <div style="margin-top:0;margin-bottom:0em;">
        2020 - <span id="dateTXTStamp"></span><script>
            const dateTXTStamp = document.getElementById('dateTXTStamp');
            dateTXTStamp.innerHTML = new Date().getFullYear();</script> BANKBOOKZ&#8482; by © NetCinematics llc. All rights reserved.
            See Apache 2.0 License. DESCRIPTION: Template for Personal_Ledger_System. 
            Charts by <a href="https://www.tradingview.com/">Trading View</a> ♥ ~:).
    </div>
</legal>
<!--[if lt IE 7]>
    <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
<![endif]-->
</body>
</html>
